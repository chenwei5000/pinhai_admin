(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b4693e2","chunk-5e62adbb"],{4926:function(t,n,e){"use strict";var i=e("4a72"),a=e.n(i);a.a},"4a72":function(t,n,e){},"84d5":function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"tag-group"},[t._l(t.primary.dataAuthories,function(n){return e("el-tag",{key:n.userId,attrs:{type:"success",closable:"","disable-transitions":!1},on:{close:function(e){return t.handleRemove(n)}}},[t._v("\n      "+t._s(n.user.name)+"\n    ")])}),t._v(" "),e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.openPersonDialog}},[t._v("+ 添加负责人")])],2),t._v(" "),e("phMembers",{ref:"members",attrs:{title:"选择采购负责人"},on:{saveCBEvent:t.saveCBEvent}})],1)},a=[],o=(e("5df3"),e("ac6a"),e("ed08"),e("d2d1")),r={components:{phMembers:o["a"]},props:{primary:{type:[Object],default:{}}},computed:{},data:function(){return{loading:!1,url:"/procurementPlans",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){},openPersonDialog:function(){this.$refs.members.openDialog()},assign:function(t){var n="".concat(this.url,"/assign/").concat(this.primary.id,"/").concat(t);return this.global.axios.put(n).then(function(t){}).catch(function(t){})},saveCBEvent:function(t){var n=this;if(t&&this.primary){var e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),i=[];t.forEach(function(t){i.push(n.assign(t))}),Promise.all(i).then(function(t){n.$refs.members.closeDialog(),n.$message.info("操作成功!"),e.close(),n.$emit("reloadCBEvent")})}},handleRemove:function(t){var n=this;t&&t.userId&&this.$confirm("确认删除吗","提示",{type:"warning",beforeClose:function(e,i,a){if("confirm"==e){var o=n.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r="".concat(n.url,"/cancelAssign/").concat(n.primary.id,"/").concat(t.userId);n.global.axios.put(r).then(function(t){a(),n.$message.info("操作成功!"),o.close(),n.$emit("reloadCBEvent")}).catch(function(t){o.close()}),a()}else a()}}).catch(function(t){})}}},c=r,s=(e("4926"),e("2877")),l=Object(s["a"])(c,i,a,!1,null,"2e408c60",null);n["default"]=l.exports},"8c66":function(t,n,e){},d2d0:function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"page-container"},[t.completed?e("aside",[t._v("\n    采购计划已经创建完毕，你可以提交上级审核了。如果不想马上提交审核，可放弃提交操作。\n    之后你可以在编辑中的采购计划中，找到本次计划，可再次进行提交。\n    您可以在计划说明中，添加本次计划的一些说明，可帮助上级更快的审核您的计划。"),e("hr"),t._v("\n    计划编号："+t._s(this.primary.code)),e("BR"),t._v("\n    计划名称："+t._s(this.primary.name)),e("BR"),t._v("\n      负责人：\n    "),t._l(this.primary.dataAuthories,function(n){return[t._v(t._s(n.user.name)+" ")]}),t._v(" "),e("BR"),t._v("\n    采购总件数："+t._s(this.primary.qty.qty)+" 件\n\n  ")],2):t._e(),t._v(" "),e("el-row",[e("el-col",{attrs:{md:12}},[e("el-row",{attrs:{type:"flex",justify:"center"}},[e("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"warning"},on:{click:t.onBack}},[t._v("\n          < 上一步\n        ")])],1)],1),t._v(" "),e("el-col",{attrs:{md:12}},[e("el-row",{attrs:{type:"flex",justify:"center"}},[e("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:t.onNext}},[t._v("\n          提交审核 >\n        ")])],1)],1)],1),t._v(" "),e("auditing",{ref:"auditing",on:{saveAuditCBEvent:t.saveAuditCBEvent}})],1)},a=[],o=(e("c5f6"),e("84d5")),r=e("88d9"),c={components:{person:o["default"],auditing:r["a"]},props:{primaryId:{type:[Number,String],default:null}},computed:{},data:function(){return{completed:!1,primary:{}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;this.primaryId&&this.global.axios.get("/procurementPlans/".concat(this.primaryId)).then(function(n){var e=n.data;t.primary=e||{},t.completed=!0}).catch(function(n){t.completed=!0})},saveAuditCBEvent:function(t){var n=this;this.$confirm("确认将该计划提交给上级审核吗?","提示",{type:"warning",beforeClose:function(e,i,a){if("confirm"==e){var o=n.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r="/procurementPlans/commit/".concat(n.primaryId);n.global.axios.put(r,t).then(function(t){a(),n.$message.info("提交成功,请耐心等待上级处理! 您还可以继续创建新的采购计划! "),n.$refs.auditing.closeDialog(),o.close(),n.$emit("step4CBEvent",0)}).catch(function(t){o.close()}),a()}else a()}}).catch(function(t){})},onNext:function(){this.$refs.auditing.openDialog("commit")},onBack:function(){this.$emit("step4CBEvent",2)},reloadCBEvent:function(){this.initData()}}},s=c,l=(e("e98d"),e("2877")),u=Object(l["a"])(s,i,a,!1,null,"432ed818",null);n["default"]=u.exports},e98d:function(t,n,e){"use strict";var i=e("8c66"),a=e.n(i);a.a}}]);