(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c08004ae"],{"642f":function(t,e,n){"use strict";var a=n("b797"),i=n.n(a);i.a},"6b1f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ph-form"},[n("el-upload",{staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-preview":t.handlePreview,"before-remove":t.beforeRemove,"on-success":t.handleSuccess,multiple:"","file-list":t.attachments}},[n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"}},[t._v("+ 添加附件")])],1)],1)},i=[],s=(n("7f7f"),n("ac6a"),n("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{uploadUrl:function(){return"".concat(this.global.generateUrl(this.url),"/uploadFiles/").concat(this.primary.id,"?accessToken=").concat(this.$store.state.user.token)}},data:function(){return{url:"/attachments/procurementOrder",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.primary){var e=this.url;this.filters&&this.filters.length>0&&(e+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(e+="&relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var n=e.data,a=n||[];t.attachments=[],a.forEach(function(e){t.attachments.push({id:e.id,name:e.fileName,url:"".concat(t.global.generateUrl(t.url),"/view/").concat(e.id,"?accessToken=").concat(t.$store.state.user.token)})})}).catch(function(t){})}},remove:function(t){var e=this;if(this.primary){var n="".concat(this.global.generateUrl(this.url),"/").concat(t.id,"?accessToken=").concat(this.$store.state.user.token);this.global.axios.delete(n).then(function(t){e.$message.info("附件删除成功!")}).catch(function(t){})}},handleSuccess:function(){this.initData()},handlePreview:function(t){window.open(t.url,"_blank")},beforeRemove:function(t,e){var n=this;return this.$confirm("确定移除 ".concat(t.name,"？"),"提示",{beforeClose:function(e,a,i){"confirm"==e?(n.remove(t),i(!0)):i(!1)}})}}}),o=s,r=(n("642f"),n("2877")),c=Object(r["a"])(o,a,i,!1,null,"09b50b96",null);e["default"]=c.exports},b797:function(t,e,n){}}]);