(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62e34a8e","chunk-5c085e76","chunk-300afe23","chunk-213f78a6","chunk-4ba56042","chunk-2d21a022"],{"0547":function(t,e,i){"use strict";var a=i("afc3"),l=i.n(a);l.a},"0832":function(t,e,i){},1767:function(t,e,i){"use strict";var a=i("cd7d"),l=i.n(a);l.a},"6ab9":function(t,e,i){"use strict";var a=i("9451"),l=i.n(a);l.a},7670:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ph-table"},[i("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchParam,id:"filter-form"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"SKU"}},[i("el-input",{attrs:{placeholder:"请输入SKU",clearable:""},model:{value:t.searchParam.skuCode,callback:function(e){t.$set(t.searchParam,"skuCode",e)},expression:"searchParam.skuCode"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{"native-type":"submit",type:"primary",size:"small"},on:{click:t.search}},[t._v("查询")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1),t._v(" "),i("tableToolBar",t._b({on:{onToolBarAdd:t.onToolBarAdd,onToolBarEdit:t.onToolBarEdit,onToolBarDelete:t.onToolBarDelete,onToolBarDownloadTpl:t.onToolBarDownloadTpl,onToolBarDownloadData:t.onToolBarDownloadData,onToolBarImportData:t.onToolBarImportData}},"tableToolBar",t.toolbarConfig,!1)),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"",border:"","highlight-current-row":"","max-height":t.tableMaxHeight,"row-class-name":t.dangerClassName,"cell-class-name":"ph-cell","header-cell-class-name":"ph-cell-header",data:t.tableData,"show-summary":"","summary-method":t.getSummaries,"default-sort":{prop:"product.skuCode",order:"ascending"},id:"table"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"sortNum",label:"序号","min-width":"50"}}),t._v(" "),i("el-table-column",{attrs:{prop:"product.skuCode",label:"SKU编码",sortable:"","min-width":"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"product.name",label:"产品名","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"cartonSpecCode",label:"箱规","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"numberOfCarton",label:"装箱数","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"procurementBoxQty",sortable:"",label:"采购数量(箱)","min-width":"130"}}),t._v(" "),i("el-table-column",{attrs:{prop:"shippedCartonQty",label:"应发箱数","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"shippedQty",sortable:"",label:"出货件数","min-width":"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"shippedNote",sortable:"",label:"备注","min-width":"200"}}),t._v(" "),t.hasOperation?i("el-table-column",{attrs:{label:"操作","no-export":"true",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasEdit?i("el-button",{attrs:{size:"small",icon:"el-icon-edit",circle:"",type:"primary",id:"ph-table-edit"},on:{click:function(i){return t.onDefaultEdit(e.row)}}}):t._e(),t._v(" "),t.hasDelete?i("el-button",{attrs:{type:"danger",size:"mini",id:"ph-table-del",icon:"el-icon-delete",circle:""},on:{click:function(i){return t.onDefaultDelete(e.row)}}}):t._e()]}}],null,!1,277848559)}):t._e()],1),t._v(" "),i("itemDialog",{ref:"itemDialog",attrs:{primaryId:t.primary.id},on:{modifyCBEvent:t.modifyCBEvent}})],1)},l=[],o=(i("7f7f"),i("386d"),i("c5f6"),i("ac6a"),i("cebc")),r=i("2f62"),n=i("ed08"),s=i("a4af"),c=i("c971"),d=i("ba4a"),u={components:{tableToolBar:s["a"],itemDialog:d["default"]},props:{primary:{type:[Object],default:null}},computed:Object(o["a"])({},Object(r["b"])(["device","rolePower"])),filters:{currency:n["b"]},data:function(){return{statusSelectOptions:[],prioritySelectOptions:[],tableMaxHeight:"mobile"!==this.device?500:4e7,confirmLoading:!1,hasOperation:!0,hasAdd:!0,hasEdit:!0,hasDelete:!0,selected:[],url:"/procurementShippedOrderItems",downloadUrl:"",searchParam:{skuCode:null,category:null,status:null,priority:null},filters:[{field:"procurementShippedOrderId",op:"eq",data:this.primary?this.primary.id:-1}],relations:["cartonSpec","product","product.currency","product.category"],data:[],tableData:[],loading:!1,row:{},toolbarConfig:{hasEdit:!0,hasDelete:!1,hasAdd:!1,hasExportTpl:!1,hasExport:!1,hasImport:!1}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData(),t.getList()})},methods:{initData:function(){this.loading=!0,this.prioritySelectOptions=c["a"].getSelectOptions("Priority"),this.statusSelectOptions=c["a"].getSelectOptions("ProcurementPlanStatus"),this.downloadUrl=this.url,this.filters&&this.filters.length>0&&(this.downloadUrl+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(this.downloadUrl+="&relations="+JSON.stringify(this.relations))},dangerClassName:function(t){var e=t.row;return 0==e.saleWeek||e.safetyStockWeek-e.saleWeek>2?"warning-row":e.saleWeek-e.safetyStockWeek>2?"danger-row":""},getSummaries:function(t){var e=t.columns,i=t.data,a=[];return e.forEach(function(t,e){if("product.skuCode"==t.property){var l=i.map(function(e){return e[t.property]});a[e]=l.reduce(function(t){return t+1},0),a[e]="合计: "+a[e]+" 行"}if("cartonQty"==t.property){var o=i.map(function(e){return Number(e[t.property])});o.every(function(t){return isNaN(t)})?a[e]="N/A":(a[e]=o.reduce(function(t,e){var i=Number(e);return isNaN(i)?t:t+e},0),a[e]+=" 箱")}if("amount"==t.property){var r=i.map(function(e){return Number(e[t.property])});r.every(function(t){return isNaN(t)})?a[e]="N/A":(a[e]=r.reduce(function(t,e){var i=Number(e);return isNaN(i)?t:t+e},0),a[e]=Object(n["b"])(a[e]))}}),a},getList:function(){var t=this,e=this.url,i="";e?(this.filters&&this.filters.length>0&&(i+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(i+="&relations="+JSON.stringify(this.relations)),this.loading=!0,this.global.axios.get(e+i).then(function(e){var i=e.data,a=i||[];t.data=a,t.search(),t.total=i.length||0,t.loading=!1,t.$emit("update",a,i)}).catch(function(e){t.$emit("error",e),t.loading=!1})):console.warn("url 为空, 不发送请求")},handleSelectionChange:function(t){this.selected=t},search:function(){var t=this;this.tableData=this.data,null!=this.searchParam.category&&""!=this.searchParam.category&&(this.tableData=this.tableData.filter(function(e){if(e.product&&e.product.category&&-1!==e.product.category.name.indexOf(t.searchParam.category))return!0})),null!=this.searchParam.skuCode&&""!=this.searchParam.skuCode&&(this.tableData=this.tableData.filter(function(e){if(e.product&&-1!==e.product.skuCode.indexOf(t.searchParam.skuCode))return!0})),null!=this.searchParam.status&&""!=this.searchParam.status&&(this.tableData=this.tableData.filter(function(e){if(e.status==t.searchParam.status)return!0})),null!=this.searchParam.priority&&""!=this.searchParam.priority&&(this.tableData=this.tableData.filter(function(e){if(e.priority==t.searchParam.priority)return!0}))},resetSearch:function(){this.$refs.searchForm.resetFields(),this.searchParam.skuCode=null,this.searchParam.category=null,this.searchParam.priority=null,this.searchParam.status=null,this.search()},onDefaultEdit:function(t){this.$refs.itemDialog.openDialog(t.id)},onDefaultDelete:function(t){var e=this;this.$confirm("确认删除吗","提示",{type:"warning",beforeClose:function(t,i,a){"confirm"==t?(e.getList(),a()):a()}}).catch(function(t){})},modifyCBEvent:function(t){this.getList()},onToolBarAdd:function(){this.$refs.itemDialog.openDialog(null)},onToolBarEdit:function(){},onToolBarDelete:function(){},onToolBarDownloadTpl:function(){var t=this.$refs.table,e=this.downloadUrl;Promise.all([i.e("chunk-d2907d8a"),i.e("chunk-748b566e")]).then(i.bind(null,"4bf8d")).then(function(i){i.export_el_table_to_excel({table:t,downloadUrl:e,filename:"采购计划内容-模版",noExportProps:["操作","金额","ID","下单件数","发货件数","收货件数"],tpl:!0})})},onToolBarDownloadData:function(){var t=this,e=this.$refs.table,a=this.downloadUrl;Promise.all([i.e("chunk-d2907d8a"),i.e("chunk-748b566e")]).then(i.bind(null,"4bf8d")).then(function(i){t.loading=!0,i.export_el_table_to_excel({table:e,downloadUrl:a,filename:"采购计划内容",noExportProps:["操作","金额","ID"]}),t.loading=!1})},onToolBarImportData:function(){}}},p=u,m=(i("c342"),i("2877")),h=Object(m["a"])(p,a,l,!1,null,"72377180",null);e["default"]=h.exports},9451:function(t,e,i){},acb1:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-upload",{staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-preview":t.handlePreview,"before-remove":t.beforeRemove,"on-success":t.handleSuccess,multiple:"","file-list":t.attachments}},[i("el-button",{staticClass:"button-new-tag"},[t._v("+ 添加附件")])],1)],1)},l=[],o=(i("7f7f"),i("ac6a"),i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{uploadUrl:function(){return"".concat(this.global.generateUrl(this.url),"/uploadFiles/").concat(this.primary.id,"?accessToken=").concat(this.$store.state.user.token)}},data:function(){return{url:"/attachments/procurementPlan",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.primary){var e=this.url;this.filters&&this.filters.length>0&&(e+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(e+="&relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data,a=i||[];t.attachments=[],a.forEach(function(e){t.attachments.push({id:e.id,name:e.fileName,url:"".concat(t.global.generateUrl(t.url),"/view/").concat(e.id,"?accessToken=").concat(t.$store.state.user.token)})})}).catch(function(t){})}},remove:function(t){var e=this;if(this.primary){var i="".concat(this.global.generateUrl(this.url),"/").concat(t.id,"?accessToken=").concat(this.$store.state.user.token);this.global.axios.delete(i).then(function(t){e.$message.info("附件删除成功!")}).catch(function(t){})}},handleSuccess:function(){this.initData()},handlePreview:function(t){window.open(t.url,"_blank")},beforeRemove:function(t,e){var i=this;return this.$confirm("确定移除 ".concat(t.name,"？"),"提示",{beforeClose:function(e,a,l){"confirm"==e?(i.remove(t),l(!0)):l(!1)}})}}}),r=o,n=(i("6ab9"),i("2877")),s=Object(n["a"])(r,a,l,!1,null,"1481a50c",null);e["default"]=s.exports},afc3:function(t,e,i){},ba4a:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogVisible?i("el-dialog",{attrs:{title:t.dialogTitle,"append-to-body":"",width:"80%",top:"20px",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"detailItem",attrs:{rules:t.rules,model:t.detailItem,"status-icon":"",inline:"","label-position":"right","label-width":"120px"}},[i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"SKU",prop:"skuCode"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写SKU",clearable:""},model:{value:t.detailItem.skuCode,callback:function(e){t.$set(t.detailItem,"skuCode","string"===typeof e?e.trim():e)},expression:"detailItem.skuCode"}}),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"输入产品SKU编码",placement:"right"}},[i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"产品名",prop:"cartonQty"}},[i("el-input",{attrs:{max:1e5,label:"产品名"},model:{value:t.detailItem.product.name,callback:function(e){t.$set(t.detailItem.product,"name",e)},expression:"detailItem.product.name"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"箱规",prop:"cartonSpecId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"外箱包装材料规格,可筛选"},model:{value:t.detailItem.cartonSpecCode,callback:function(e){t.$set(t.detailItem,"cartonSpecCode",e)},expression:"detailItem.cartonSpecCode"}},t._l(t.cartonspecSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"产品外箱包装材料规格。不输入使用产品上默认的箱规",placement:"right"}},[i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"装箱数",prop:"numberOfCarton"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请填写装箱数",clearable:""},model:{value:t.detailItem.numberOfCarton,callback:function(e){t.$set(t.detailItem,"numberOfCarton","string"===typeof e?e.trim():e)},expression:"detailItem.numberOfCarton"}}),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"一箱有多少个产品.不输入使用产品上默认的装箱数",placement:"right"}},[i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"采购数量(箱)",prop:"procurementBoxQty"}},[i("el-input",{attrs:{max:1e5,label:"采购数量(箱)"},model:{value:t.detailItem.procurementBoxQty,callback:function(e){t.$set(t.detailItem,"procurementBoxQty",e)},expression:"detailItem.procurementBoxQty"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"应发箱数",prop:"shippedCartonQty"}},[i("el-input",{attrs:{max:1e5,label:"应发箱数"},model:{value:t.detailItem.shippedCartonQty,callback:function(e){t.$set(t.detailItem,"shippedCartonQty",e)},expression:"detailItem.shippedCartonQty"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"出货件数",prop:"sevenSalesCount"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"出货件数",clearable:""},model:{value:t.detailItem.shippedQty,callback:function(e){t.$set(t.detailItem,"shippedQty","string"===typeof e?e.trim():e)},expression:"detailItem.shippedQty"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-form-item",{attrs:{label:"备注",prop:"priorityNote"}},[i("el-col",{attrs:{span:22}},[i("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:"3",cols:"80"},model:{value:t.detailItem.shippedNote,callback:function(e){t.$set(t.detailItem,"shippedNote",e)},expression:"detailItem.shippedNote"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"light",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("按时间维度定义优先要求。格式如下：\n                "),i("HR"),t._v("\n                2018-08-16 : 5箱"),i("BR"),t._v("\n                2018-08-26 : 45件"),i("BR"),t._v("\n                2018-09-16 : 2箱"),i("BR")],1),t._v(" "),i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.onSave}},[t._v("\n            保存\n          ")])],1)],1)],1)],1)],1):t._e()},l=[],o=(i("c5f6"),i("d186")),r=i("c971"),n=i("b99d"),s={components:{},props:{primaryId:{type:Number,default:null}},computed:{dialogTitle:function(){return null==this.detailItemId?"添加采购计划明细":"修改采购计划明细"}},data:function(){return{dialogVisible:!1,loading:!1,confirmLoading:!1,url:"/procurementShippedOrderItems",relations:["product","cartonSpec"],detailItemId:null,detailItem:{},cartonspecSelectOptions:[],prioritySelectOptions:[],rules:{skuCode:[n["a"].required]}}},created:function(){},mounted:function(){this.$nextTick(function(){})},methods:{initData:function(){var t=this;if(this.cartonspecSelectOptions=o["a"].getSelectOptions(),this.prioritySelectOptions=r["a"].getSelectOptions("Priority"),this.detailItemId){this.loading=!0;var e="".concat(this.url,"/").concat(this.detailItemId);this.relations&&this.relations.length>0&&(e+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data,a=i||{};t.detailItem=a,t.detailItem.cartonSpecId=a.cartonSpecId+"",t.detailItem.priority=a.priority+"",t.loading=!1})}else this.detailItem={skuCode:"",priorityNote:"",cartonSpecId:null,priority:"2",safetyStockWeek:10,numberOfCarton:null,cartonQty:1,procurementPlanId:this.primaryId}},openDialog:function(t){this.detailItemId=t,this.dialogVisible=!0,this.initData()},onSave:function(){var t=this;this.$refs.detailItem.validate(function(e){if(!e)return!1;t.loading=!0,t.confirmLoading=!0;var i="post",a=t.url+"";!t.detailItemId&&t.detailItemId>0&&(i="put",a="".concat(t.url,"/").concat(t.detailItemId));var l=JSON.parse(JSON.stringify(t.detailItem));t.global.axios[i](a,l).then(function(e){t.$message.info("修改成功"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})})}}},c=s,d=i("2877"),u=Object(d["a"])(c,a,l,!1,null,"785b0bed",null);e["default"]=u.exports},bc3f:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"editObject",attrs:{rules:t.rules,model:t.editObject,"status-icon":"",inline:"","label-position":"right","label-width":"120px"}},[i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"发货计划编码",prop:"code"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",placeholder:"请填写编码",clearable:""},model:{value:t.editObject.code,callback:function(e){t.$set(t.editObject,"code",e)},expression:"editObject.code"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"发货厂商",prop:"supplierId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.editObject.supplierId,callback:function(e){t.$set(t.editObject,"supplierId",e)},expression:"editObject.supplierId"}},t._l(t.supplierSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"收货仓库",prop:"warehouseId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"请选择",change:t.warehouseChange()},model:{value:t.editObject.warehouseId,callback:function(e){t.$set(t.editObject,"warehouseId",e)},expression:"editObject.warehouseId"}},t._l(t.warehouseSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"预计发货时间",prop:"expectTime"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date",placeholder:"交货截止日"},model:{value:t.editObject.expectTime,callback:function(e){t.$set(t.editObject,"expectTime",e)},expression:"editObject.expectTime"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"单号",prop:"trackNumber"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",placeholder:"请填写单号",clearable:""},model:{value:t.editObject.trackNumber,callback:function(e){t.$set(t.editObject,"trackNumber",e)},expression:"editObject.trackNumber"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"公司",prop:"channel"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写公司",clearable:""},model:{value:t.editObject.channel,callback:function(e){t.$set(t.editObject,"channel",e)},expression:"editObject.channel"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"车牌",prop:"plateNumber"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",placeholder:"请填写车牌",clearable:""},model:{value:t.editObject.plateNumber,callback:function(e){t.$set(t.editObject,"plateNumber",e)},expression:"editObject.plateNumber"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"联系人",prop:"linkman"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写联系人",clearable:""},model:{value:t.editObject.linkman,callback:function(e){t.$set(t.editObject,"linkman",e)},expression:"editObject.linkman"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:18}},[i("el-form-item",{attrs:{label:"电话",prop:"tel"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写电话",clearable:""},model:{value:t.editObject.tel,callback:function(e){t.$set(t.editObject,"tel",e)},expression:"editObject.tel"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:22}},[i("el-form-item",{attrs:{label:"运费",prop:"shippingPrice"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写编运费",clearable:""},model:{value:t.editObject.shippingPrice,callback:function(e){t.$set(t.editObject,"shippingPrice",e)},expression:"editObject.shippingPrice"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-form-item",{attrs:{label:"备注",prop:"note"}},[i("el-col",{attrs:{span:22}},[i("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:"3",cols:"80","show-word-limit":""},model:{value:t.editObject.remark,callback:function(e){t.$set(t.editObject,"remark",e)},expression:"editObject.remark"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"备注信息。支持换行！",placement:"right"}},[i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.onSave}},[t._v("\n          保存基本信息\n        ")])],1)],1)],1)],1)},l=[],o=(i("ac6a"),i("c405")),r=i("64dc"),n=i("8492"),s=i("a6b9"),c=i("8593"),d=(i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{},data:function(){return{loading:!1,confirmLoading:!1,warehouseSelectOptions:[],supplierSelectOptions:[],editObject:{},rules:{code:[{required:!0,message:"必须输入",trigger:"blur"}],supplierId:[{required:!0,message:"必须输入",trigger:"blur"}],warehouseId:[{required:!0,message:"必须输入",trigger:"blur"}]}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.loading=!0,this.primary){this.editObject=this.primary,this.editObject.limitTime=this.primary.formatLimitTime,this.editObject.executeTime=this.primary.formatExecuteTime,this.categorySelectOptions=o["a"].getMineSelectOptions(),this.merchantSelectOptions=n["a"].getSelectOptions(),this.warehouseSelectOptions=r["a"].getSelectDomesticOptions(),this.supplierSelectOptions=s["a"].getSelectOptions(),this.editObject.warehouseId=this.editObject.warehouseId+"",this.editObject.supplierId=this.editObject.supplierId+"",c["a"].getConfigInfos().then(function(e){null==t.editObject.safetyStockWeek&&(t.editObject.safetyStockWeek=e.safetyStockWeek),null==t.editObject.vip1SafetyStockWeek&&(t.editObject.vip1SafetyStockWeek=e.vip1SafetyStockWeek),null==t.editObject.vip2SafetyStockWeek&&(t.editObject.vip2SafetyStockWeek=e.vip2SafetyStockWeek)});var e=!0;this.warehouseSelectOptions.forEach(function(t){"-99"==t.value&&(e=!1)}),e&&this.warehouseSelectOptions.unshift({label:"供货商库存",value:"-99"}),this.loading=!1}else this.$message.error("无效的采购计划!"),this.loading=!1},onSave:function(){var t=this;this.$confirm("注意保存基本信息只会修改对应的参数，不会重新计算明细数据，您是否继续？","提示",{type:"warning",beforeClose:function(e,i,a){"confirm"==e?(a(),t.modifyObject()):a()}}).catch(function(t){})},modifyObject:function(){var t=this,e=JSON.parse(JSON.stringify(this.editObject));console.log("fdfdlfjd",e),this.loading=!0,this.confirmLoading=!0,this.global.axios.put("/procurementShippedOrders/".concat(this.editObject.id),e).then(function(e){var i=e.data;t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.confirmLoading=!1,t.formVisible=!1,t.$emit("modifyCBEvent",i)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})},warehouseChange:function(){}}}),u=d,p=(i("0547"),i("2877")),m=Object(p["a"])(u,a,l,!1,null,"691db99f",null);e["default"]=m.exports},c342:function(t,e,i){"use strict";var a=i("0832"),l=i.n(a);l.a},cd7d:function(t,e,i){},fca1:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogVisible?i("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,fullscreen:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-row",{staticStyle:{"margin-bottom":"20px"}},[4==t.primary.status?i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-left"},on:{click:t.onWithdraw}},[t._v("撤回\n    ")]):t._e(),t._v(" "),3==t.primary.status?i("el-button",{attrs:{type:"success",icon:"el-icon-s-claim"},on:{click:t.onComplete}},[t._v("确认发货")]):t._e(),t._v(" "),3==t.primary.status?i("el-button",{attrs:{type:"primary",icon:"el-icon-s-goods"},on:{click:t.onPrint}},[t._v("打印发货单")]):t._e()],1),t._v(" "),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"infoFrom"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("1. 基本信息")]),t._v(" "),i("infoFrom",{ref:"infoFrom",attrs:{primary:t.primary},on:{modifyCBEvent:t.modifyCBEvent}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"itemTable"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("2. 发货计划内容")]),t._v(" "),i("itemTable",{ref:"itemTable",attrs:{primary:t.primary}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"attachment"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("3. 附件")]),t._v(" "),i("attachment",{ref:"attachment",attrs:{primary:t.primary}})],1)],1)],1):t._e()},l=[],o=i("bc3f"),r=i("7670"),n=i("acb1"),s={components:{infoFrom:o["default"],itemTable:r["default"],attachment:n["default"]},props:{},computed:{hasExecute:function(){return[2,3,4,5,6,7].indexOf(this.primary.status)>-1},title:function(){return"编辑发货计划 ["+this.primary.code+"] -- ("+this.primary.statusName+"状态)"}},data:function(){return{primaryId:null,primary:{},dialogVisible:!1,activeNames:[],relations:["supplier","warehouse"],url:"/procurementShippedOrders"}},created:function(){},mounted:function(){this.$nextTick(function(){})},methods:{initData:function(){var t=this;if(this.primaryId){var e="".concat(this.url,"/").concat(this.primaryId);this.relations&&this.relations.length>0&&(e+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data;t.primary=i||{},t.dialogVisible=!0}).catch(function(t){})}},openDialog:function(t){this.primaryId=t,this.initData()},modifyCBEvent:function(t){this.$emit("modifyCBEvent",t)},onCommit:function(){},onAgree:function(){},onRefuse:function(){},onWithdraw:function(){var t=this;this.global.axios.put("/procurementShippedOrders/withdraw/".concat(this.primary.id)).then(function(e){var i=e.data;t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.formVisible=!1,t.$emit("modifyCBEvent",i)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})},onComplete:function(){var t=this;this.global.axios.put("/procurementShippedOrders/shippedOrderConfirm/".concat(this.primary.id)).then(function(e){var i=e.data;t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.formVisible=!1,t.$emit("modifyCBEvent",i)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})}}},c=s,d=(i("1767"),i("2877")),u=Object(d["a"])(c,a,l,!1,null,"1f26d9a9",null);e["default"]=u.exports}}]);