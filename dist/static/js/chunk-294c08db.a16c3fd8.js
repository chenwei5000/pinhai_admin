(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-294c08db","chunk-02d20f0b","chunk-1ada2dba"],{"04a0":function(t,e,a){},"0c50":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"infoFrom"}},[a("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("1. 基本信息")]),t._v(" "),t.completed?a("infoFrom",{ref:"infoFrom",attrs:{primary:t.primary},on:{modifyCBEvent:t.modifyCBEvent}}):t._e()],1),t._v(" "),a("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"itemTable"}},[a("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("2. 采购计划内容")]),t._v(" "),t.completed?a("itemTable",{ref:"itemTable",attrs:{primary:t.primary}}):t._e()],1),t._v(" "),a("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"attachment"}},[a("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("3. 附件")]),t._v(" "),t.completed?a("attachment",{ref:"attachment",attrs:{primary:t.primary}}):t._e()],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:24}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary"},on:{click:t.onNext}},[t._v("\n          下一步 >\n        ")])],1)],1)],1)],1)},n=[],s=(a("c5f6"),a("1311")),r=a("ee0f"),o=a("4595"),l={components:{infoFrom:s["default"],itemTable:r["default"],attachment:o["default"]},props:{primaryId:{type:[Number,String],default:null}},computed:{},data:function(){return{completed:!1,primary:{},activeNames:["infoFrom","itemTable","attachment"]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;this.primaryId&&this.global.axios.get("/procurementPlans/".concat(this.primaryId)).then(function(e){var a=e.data;t.primary=a||{},t.completed=!0}).catch(function(e){t.completed=!0})},onNext:function(){this.$emit("step2CBEvent",2)},onBack:function(){this.$emit("step2CBEvent",0)},modifyCBEvent:function(t){},reloadCBEvent:function(){this.initData()}}},c=l,u=(a("5e08"),a("2877")),p=Object(u["a"])(c,i,n,!1,null,"7fe0a509",null);e["default"]=p.exports},"127b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("aside",[t._v("\n    为了保证本采购计划的执行，需要指派对应的采购负责人，可多选。指派的采购负责人将会收到对应的邮件和系统消息提醒。\n    默认会自动把对应品类的采购负责人自动选中。\n  ")]),t._v(" "),a("h5",[t._v("采购负责人：")]),t._v(" "),t.completed?a("person",{ref:"person",attrs:{primary:t.primary},on:{reloadCBEvent:t.reloadCBEvent}}):t._e(),t._v(" "),a("el-row",[a("el-col",{attrs:{md:12}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"warning"},on:{click:t.onBack}},[t._v("\n          < 上一步\n        ")])],1)],1),t._v(" "),a("el-col",{attrs:{md:12}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:t.onNext}},[t._v("\n          下一步 >\n        ")])],1)],1)],1)],1)},n=[],s=(a("c5f6"),a("84d5")),r={components:{person:s["default"]},props:{primaryId:{type:[Number,String],default:null}},computed:{},data:function(){return{completed:!1,primary:{}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;this.primaryId&&this.global.axios.get("/procurementPlans/".concat(this.primaryId)).then(function(e){var a=e.data;t.primary=a||{},t.completed=!0}).catch(function(e){t.completed=!0})},onNext:function(){this.primary&&this.primary.dataAuthories&&this.primary.dataAuthories.length>0?this.$emit("step3CBEvent",3):this.$message.error("必须选择采购负责人")},onBack:function(){this.$emit("step3CBEvent",1)},reloadCBEvent:function(){this.initData()}}},o=r,l=(a("91aa"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,"14653e61",null);e["default"]=c.exports},"2f21":function(t,e,a){"use strict";var i=a("79e5");t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},3144:function(t,e,a){"use strict";var i=a("809b"),n=a.n(i);n.a},"55dd":function(t,e,a){"use strict";var i=a("5ca1"),n=a("d8e8"),s=a("4bf8"),r=a("79e5"),o=[].sort,l=[1,2,3];i(i.P+i.F*(r(function(){l.sort(void 0)})||!r(function(){l.sort(null)})||!a("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(s(this)):o.call(s(this),n(t))}})},"5e08":function(t,e,a){"use strict";var i=a("04a0"),n=a.n(i);n.a},"711f":function(t,e,a){},"809b":function(t,e,a){},"8c66":function(t,e,a){},"90b4":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-steps",{attrs:{active:t.stepsActive,"finish-status":"success","align-center":"",simple:""}},[a("el-step",{attrs:{title:"1.智能备货",icon:"el-icon-reading"}}),t._v(" "),a("el-step",{attrs:{title:"2.采购计划",icon:"el-icon-picture"}}),t._v(" "),a("el-step",{attrs:{title:"3.指派工作",icon:"el-icon-upload"}}),t._v(" "),a("el-step",{attrs:{title:"4.提交审核",icon:"el-icon-edit"}})],1),t._v(" "),0==t.stepsActive?a("step1",{on:{step1CBEvent:t.step1CBEvent}}):t._e(),t._v(" "),1==t.stepsActive?a("step2",{attrs:{primaryId:t.object.id},on:{step2CBEvent:t.step2CBEvent}}):t._e(),t._v(" "),2==t.stepsActive?a("step3",{attrs:{primaryId:t.object.id},on:{step3CBEvent:t.step3CBEvent}}):t._e(),t._v(" "),3==t.stepsActive?a("step4",{attrs:{primaryId:t.object.id},on:{step4CBEvent:t.step4CBEvent}}):t._e()],1)},n=[],s=a("40c6"),r=a("0c50"),o=a("127b"),l=a("d2d0"),c={components:{step1:s["default"],step2:r["default"],step3:o["default"],step4:l["default"]},props:{},computed:{},data:function(){return{stepsActive:0,object:{id:null}}},created:function(){},mounted:function(){},methods:{step1CBEvent:function(t){this.$emit("createCBEvent",t),t&&(this.object.id=t,this.stepsActive=1)},step2CBEvent:function(t){this.stepsActive=t,this.$emit("createCBEvent",this.object.id)},step3CBEvent:function(t){this.stepsActive=t},step4CBEvent:function(t){this.stepsActive=t}}},u=c,p=(a("dd22"),a("2877")),d=Object(p["a"])(u,i,n,!1,null,"568ba1b6",null);e["default"]=d.exports},"91aa":function(t,e,a){"use strict";var i=a("9b90"),n=a.n(i);n.a},"9b90":function(t,e,a){},a62a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("infoTable",{ref:"infoTable",attrs:{type:t.type,defaultFilters:t.filters}})},n=[],s=a("ac58"),r={components:{infoTable:s["default"]},props:{type:{type:String,default:"valid"}},computed:{filters:function(){return"editing"===this.type?{field:"status",op:"in",data:1}:"auditing"===this.type?{field:"status",op:"in",data:0}:"executing"===this.type?{field:"status",op:"in",data:"2,3,4,5,6,7"}:"complete"===this.type?{field:"status",op:"in",data:8}:"all"===this.type?{}:void 0}},methods:{onRefreshTable:function(){this.$refs.infoTable.onRefreshTable()}}},o=r,l=a("2877"),c=Object(l["a"])(o,i,n,!1,null,null,null);e["default"]=c.exports},ac58:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ph-table"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchParam,id:"filter-form","inline-message":""},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"编码"}},[a("el-input",{staticStyle:{width:"110px"},attrs:{size:"mini",placeholder:"请输入编码"},model:{value:t.searchParam.code.value,callback:function(e){t.$set(t.searchParam.code,"value",e)},expression:"searchParam.code.value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{staticStyle:{width:"110px"},attrs:{size:"mini",placeholder:"请输入名称"},model:{value:t.searchParam.name.value,callback:function(e){t.$set(t.searchParam.name,"value",e)},expression:"searchParam.name.value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"下单截止日"}},[a("el-date-picker",{attrs:{size:"mini",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.searchParam.limitTime.value,callback:function(e){t.$set(t.searchParam.limitTime,"value",e)},expression:"searchParam.limitTime.value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",filterable:"",placeholder:"请选择状态"},model:{value:t.searchParam.status.value,callback:function(e){t.$set(t.searchParam.status,"value",e)},expression:"searchParam.status.value"}},t._l(t.statusSelectOptions,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{"native-type":"submit",type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"",border:"","highlight-current-row":"","row-class-name":t.dangerClassName,"cell-class-name":"ph-cell","header-cell-class-name":"ph-cell-header",data:t.data,"max-height":t.tableMaxHeight,id:"table"},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSortChange}},[a("el-table-column",{attrs:{prop:"code",label:"编号",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"small",type:1===e.row.status?"warning":0===e.row.status?"danger":2===e.row.status?"primary":8===e.row.status?"info":"success","disable-transitions":""}},[t._v(t._s(e.row.statusName)+"\n        ")])]}}])}),t._v(" "),t.hasCompleteness?a("el-table-column",{attrs:{prop:"note",label:"完成度",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",title:"完成度",width:"250",trigger:"hover"}},[a("div",[t._v("\n            完成度："+t._s(e.row.qty.completeness)+"%"),a("BR"),t._v("\n            总件数："+t._s(e.row.qty.qty)+" 件"),a("BR"),t._v("\n            已下单："+t._s(e.row.qty.orderQty)+" 件 ("+t._s(e.row.qty.orderedCompleteness)+"%) "),a("BR"),t._v("\n            已发货："+t._s(e.row.qty.shippedQty)+" 件 ("+t._s(e.row.qty.shippedCompleteness)+"%)"),a("BR"),t._v("\n            已收货："+t._s(e.row.qty.receivedQty)+" 件 ("+t._s(e.row.qty.receivedCompleteness)+"%) "),a("BR")],1),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[a("el-progress",{attrs:{"text-inside":!0,"stroke-width":16,percentage:e.row.qty.completeness>100?100:e.row.qty.completeness,status:"success"}})],1)])]}}],null,!1,547056202)}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"categoryName",label:"分类","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.categoryName&&e.row.categoryName.length>10?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[a("div",{domProps:{innerHTML:t._s(e.row.categoryName)}}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.categoryName?e.row.categoryName.length>10?e.row.categoryName.substr(0,8)+"..":e.row.categoryName:""))])]):a("span",[t._v("\n          "+t._s(e.row.categoryName)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.name&&e.row.name.length>27?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[a("div",{domProps:{innerHTML:t._s(e.row.name)}}),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.name?e.row.name.length>27?e.row.name.substr(0,25)+"..":e.row.name:""))])]):a("span",[t._v("\n          "+t._s(e.row.name)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"formatLimitTime",label:"期望交货日期",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tags",label:"标签",width:"120"}}),t._v(" "),t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"creator.name",label:"创建人",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),t._v(" "),t.hasOperation?a("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasEdit?a("el-button",{attrs:{size:"small",icon:"el-icon-edit",circle:"",type:"primary",id:"ph-table-edit"},on:{click:function(a){return t.onDefaultEdit(e.row)}}}):t._e(),t._v(" "),t.hasDelete?a("el-button",{attrs:{type:"danger",size:"mini",id:"ph-table-del",icon:"el-icon-delete",circle:""},on:{click:function(a){return t.onDefaultDelete(e.row)}}}):t._e()]}}],null,!1,277848559)}):t._e()],1),t._v(" "),a("el-pagination",{ref:"pageForm",staticStyle:{"text-align":"right",padding:"10px 0"},attrs:{"current-page":t.page,"page-sizes":t.paginationSizes,"page-size":t.size,total:t.total,background:"",layout:t.layout,id:"ph-table-page"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("el-button",{staticClass:"btn-prev",attrs:{icon:"el-icon-refresh",circle:""},on:{click:t.onRefreshTable}})],1),t._v(" "),a("editDialog",{ref:"editDialog",on:{modifyCBEvent:t.modifyCBEvent}})],1)},n=[],s=(a("386d"),a("6b54"),a("456d"),a("ac6a"),a("7f7f"),a("55dd"),a("a481"),a("4917"),a("cebc")),r=(a("3b2b"),a("2f62")),o=a("4328"),l=a.n(o),c=a("d3cd"),u=a("c971"),p=a("3978"),d="~",h=new RegExp(d,"g"),m=",",f="=",v=/=/g,g="q=",y=new RegExp("q=.*"+m),b={components:{editDialog:c["default"],phPercentage:p["a"]},props:{type:{type:String,default:"valid"},defaultFilters:{type:Object,default:{}}},computed:Object(s["a"])({},Object(r["b"])(["device","rolePower","rolePower"]),{hasCompleteness:function(){return"editing"!==this.type&&("auditing"!==this.type&&("executing"===this.type||("complete"===this.type||("all"===this.type||void 0))))}}),data:function(){return{tableMaxHeight:"mobile"!==this.device?400:4e7,hasOperation:!0,hasEdit:!0,hasDelete:!0,selected:[],size:20,page:1,layout:"total, sizes, slot, prev, pager, next, jumper",paginationSizes:[1,20,50,100],total:0,url:"/procurementPlans",countUrl:"/procurementPlans/count",relations:["creator"],data:[],phSort:{prop:"id",order:"desc"},loading:!1,statusSelectOptions:[],categorySelectOptions:[],searchParam:{categoryId:{value:null,op:"in",id:"categoryId"},name:{value:null,op:"bw",id:"name"},limitTime:{value:null,op:"timeRange",id:"limitTime"},status:{value:null,op:"eq",id:"status"},code:{value:null,op:"bw",id:"name"}},dialogTitle:"新增",dialogVisible:!1,isNew:!0,isEdit:!1,isView:!1,row:{}}},created:function(){},mounted:function(){var t=this;window.onresize=function(){t.getTableHeight()};var e=location.href.match(y);if(e){var a=e[0].substr(2).replace(h,f),i=l.a.parse(a,{delimiter:m});this.page=i.currentPage?1*i.currentPage:this.page,this.size=i.pageSize?1*i.pageSize:this.size,this.phSort.prop=i.sort?i.sort:this.phSort.prop,this.phSort.order=i.dir?i.dir:this.phSort.order,i.categoryId&&(this.searchParam.categoryId.value=i.categoryId),i.limitTime&&(this.searchParam.limitTime.value=i.limitTime),i.name&&(this.searchParam.name.value=i.name),i.status&&(this.searchParam.status.value=i.status),i.code&&(this.searchParam.code.value=i.code)}this.$nextTick(function(){t.getTableHeight(),t.initData(),t.getList()})},methods:{initData:function(){this.statusSelectOptions=u["a"].getSelectOptions("ProcurementPlanStatus"),"editing"===this.type||("auditing"===this.type?this.hasDelete=!1:"executing"===this.type?this.hasDelete=!1:"complete"===this.type?this.hasDelete=!1:this.type)},getTableHeight:function(){if("mobile"!==this.device){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=t;e-=84,e-=this.$refs.searchForm?this.$refs.searchForm.$el.offsetHeight:0,e-=this.$refs.operationForm?this.$refs.operationForm.$el.offsetHeight:0,e-=this.$refs.pageForm?this.$refs.pageForm.$el.offsetHeight:0,e-=82,this.tableMaxHeight=e}else this.tableMaxHeight=400},search:function(){var t=this;this.$refs.searchForm.validate(function(e){e&&(t.page=1,t.getList(!0))})},resetSearch:function(){var t=this;this.$refs.searchForm.resetFields(),this.page=1,this.searchParam.categoryId.value=null,this.searchParam.limitTime.value=null,this.searchParam.name.value=null,this.searchParam.status.value=null,this.searchParam.code.value=null,history.replaceState(history.state,"",location.href.replace(y,"")),this.$nextTick(function(){t.getList()}),this.$emit("reset"),this.$emit("update:customQuery",Object.assign(this.customQuery,JSON.parse(this.initCustomQuery)))},exempleFormatter:function(t,e){return""},dangerClassName:function(t){t.row;return""},getList:function(t){var e=this,a=this.url,i=this.countUrl,n="",s="",r=this.size,o=this.page;if(a)if(i){a.indexOf("?")>-1?a+="&":a+="?",i.indexOf("?")>-1?i+="&":i+="?",n+="pageSize=".concat(r,"&currentPage=").concat(o),s+="pageSize=".concat(r,"&currentPage=").concat(o),this.phSort&&(n+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order),s+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order));var l=[];if(Object.keys(this.searchParam).filter(function(t){return e.searchParam[t]&&""!==e.searchParam[t].value&&null!==e.searchParam[t].value&&void 0!==e.searchParam[t].value}).forEach(function(t){l.push({field:t,op:e.searchParam[t].op?e.searchParam[t].op:"eq",data:e.searchParam[t].value?encodeURIComponent(e.searchParam[t].value.toString().trim()):""})}),l.forEach(function(t,e){s+="&"+t.field+"="+encodeURIComponent(t.data?t.data.toString().trim():"")}),l.push(JSON.parse(JSON.stringify(this.defaultFilters))),l&&l.length>0&&(n+="&filters="+JSON.stringify({groupOp:"AND",rules:l})),this.relations&&this.relations.length>0&&(n+="&relations="+JSON.stringify(this.relations)),this.loading=!0,this.global.axios.get(i+n).then(function(t){var a=t.data;e.total=a||0}).catch(function(t){}),this.global.axios.get(a+n).then(function(t){var a=t.data,i=a||[];e.data=i,e.loading=!1,e.$emit("update",i,a)}).catch(function(t){e.$emit("error",t),e.loading=!1}),t>0){var c="",u=g+s.replace(/&/g,m).replace(v,d)+m;if(location.href.indexOf(g)>-1)c=location.href.replace(y,u);else{var p=location.href.indexOf("?")>-1?"&".concat(u):"?".concat(u);c=location.origin+location.pathname+location.search+location.hash+p}history.pushState(history.state,"ph-table search",c)}}else console.warn("countUrl 为空, 异常！如果不需要统计结果数量。请查找删除 countUrl 相关代码!");else console.warn("url 为空, 不发送请求")},handleSelectionChange:function(t){this.selected=t,this.$emit("selection-change",t)},handleSortChange:function(t){t.prop&&(this.phSort.prop=t.prop,this.phSort.order="ascending"===t.order?"asc":"desc"),this.page=1,this.getList(!0)},handleSizeChange:function(t){this.size!==t&&(this.page=1,this.size=t,this.getList(!0))},handleCurrentChange:function(t){this.page!==t&&(this.page=t,this.getList(!0))},onRefreshTable:function(){this.getList()},onDefaultEdit:function(t){this.$refs.editDialog.openDialog(t.id)},onDefaultDelete:function(t){var e=this,a="".concat(this.url,"/").concat(t.id);this.$confirm("确认删除吗?","提示",{type:"warning",beforeClose:function(t,i,n){"confirm"==t?(e.loading=!0,e.global.axios.delete(a).then(function(t){e.loading=!1,e.$message.info("删除成功!"),n(),e.getList()}).catch(function(t){e.loading=!1})):n()}}).catch(function(t){})},modifyCBEvent:function(t){this.getList()}}},_=b,w=(a("3144"),a("2877")),C=Object(w["a"])(_,i,n,!1,null,"5386c8c6",null);e["default"]=C.exports},d2d0:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[t.completed?a("aside",[t._v("\n    采购计划已经创建完毕，你可以提交上级审核了。如果不想马上提交审核，可放弃提交操作。\n    之后你可以在编辑中的采购计划中，找到本次计划，可再次进行提交。\n    您可以在计划说明中，添加本次计划的一些说明，可帮助上级更快的审核您的计划。"),a("hr"),t._v("\n    计划编号："+t._s(this.primary.code)),a("BR"),t._v("\n    计划名称："+t._s(this.primary.name)),a("BR"),t._v("\n      负责人：\n    "),t._l(this.primary.dataAuthories,function(e){return[t._v(t._s(e.user.name)+" ")]}),t._v(" "),a("BR"),t._v("\n    采购总件数："+t._s(this.primary.qty.qty)+" 件\n\n  ")],2):t._e(),t._v(" "),a("el-row",[a("el-col",{attrs:{md:12}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"warning"},on:{click:t.onBack}},[t._v("\n          < 上一步\n        ")])],1)],1),t._v(" "),a("el-col",{attrs:{md:12}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"40px"},attrs:{type:"primary"},on:{click:t.onNext}},[t._v("\n          提交审核 >\n        ")])],1)],1)],1),t._v(" "),a("auditing",{ref:"auditing",on:{saveAuditCBEvent:t.saveAuditCBEvent}})],1)},n=[],s=(a("c5f6"),a("84d5")),r=a("88d9"),o={components:{person:s["default"],auditing:r["a"]},props:{primaryId:{type:[Number,String],default:null}},computed:{},data:function(){return{completed:!1,primary:{}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;this.primaryId&&this.global.axios.get("/procurementPlans/".concat(this.primaryId)).then(function(e){var a=e.data;t.primary=a||{},t.completed=!0}).catch(function(e){t.completed=!0})},saveAuditCBEvent:function(t){var e=this;this.$confirm("确认将该计划提交给上级审核吗?","提示",{type:"warning",beforeClose:function(a,i,n){if("confirm"==a){var s=e.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r="/procurementPlans/commit/".concat(e.primaryId);e.global.axios.put(r,t).then(function(t){n(),e.$message.info("提交成功,请耐心等待上级处理! 您还可以继续创建新的采购计划! "),e.$refs.auditing.closeDialog(),s.close(),e.$emit("step4CBEvent",0)}).catch(function(t){s.close()}),n()}else n()}}).catch(function(t){})},onNext:function(){this.$refs.auditing.openDialog("commit")},onBack:function(){this.$emit("step4CBEvent",2)},reloadCBEvent:function(){this.initData()}}},l=o,c=(a("e98d"),a("2877")),u=Object(c["a"])(l,i,n,!1,null,"432ed818",null);e["default"]=u.exports},dd22:function(t,e,a){"use strict";var i=a("711f"),n=a.n(i);n.a},e98d:function(t,e,a){"use strict";var i=a("8c66"),n=a.n(i);n.a},f55e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"ph-card"},[a("div",{staticClass:"ph-card-body"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleTabClick},model:{value:t.activeStatus,callback:function(e){t.activeStatus=e},expression:"activeStatus"}},[a("el-tab-pane",{attrs:{name:"create",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-circle-plus-outline"}),t._v(" 创建计划\n          ")]),t._v(" "),a("keep-alive",[a("phCreate",{on:{createCBEvent:t.createCBEvent}})],1)],1),t._v(" "),a("el-tab-pane",{staticClass:"fontColor",attrs:{name:"editing",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-edit"}),t._v(" 编辑中\n          ")]),t._v(" "),a("keep-alive",[a("phTab",{ref:"editTable",attrs:{type:"editing"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{name:"auditing",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-check"}),t._v(" 待审核\n          ")]),t._v(" "),a("keep-alive",[a("phTab",{attrs:{type:"auditing"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{name:"executing",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-flag"}),t._v(" 执行中\n          ")]),t._v(" "),a("keep-alive",[a("phTab",{attrs:{type:"executing"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{name:"complete",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-claim"}),t._v(" 完成\n          ")]),t._v(" "),a("keep-alive",[a("phTab",{attrs:{type:"complete"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{name:"all",lazy:""}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-s-order"}),t._v(" 全部\n          ")]),t._v(" "),a("keep-alive",[a("phTab",{attrs:{type:"all"}})],1)],1)],1)],1)])])},n=[],s=a("a62a"),r=a("90b4"),o="s=",l={components:{phTab:s["default"],phCreate:r["default"]},data:function(){return{title:"采购计划管理",activeStatus:location.href.indexOf(o)>-1&&null!==this.$route.query.s?this.$route.query.s:"editing"}},computed:{},methods:{handleTabClick:function(t,e){var a="?s=",i="/m2/ProcurementPlan_index",n=location.origin+"/#"+i+a+this.activeStatus;history.pushState(history.state,"ph-table search",n)},createCBEvent:function(t){t&&this.$refs.editTable&&this.$refs.editTable.onRefreshTable()}}},c=l,u=a("2877"),p=Object(u["a"])(c,i,n,!1,null,"99ae0bea",null);e["default"]=p.exports}}]);