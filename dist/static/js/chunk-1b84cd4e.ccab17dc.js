(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b84cd4e","chunk-519952c4"],{"27dd":function(e,t,a){},"2d66":function(e,t,a){},"2f21":function(e,t,a){"use strict";var l=a("79e5");e.exports=function(e,t){return!!e&&l(function(){t?e.call(null,function(){},1):e.call(null)})}},3514:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"createForm",attrs:{rules:e.rules,model:e.newProduct,"status-icon":"","label-position":"right",inline:"","label-width":"90px"}},[a("fieldset",{staticClass:"panel-heading"},[a("legend",{staticClass:"panel-title"},[e._v("基本信息")]),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:e.newProduct.status,callback:function(t){e.$set(e.newProduct,"status",e._n(t))},expression:"newProduct.status"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")]),e._v(" "),a("el-radio-button",{attrs:{label:"0"}},[e._v("关闭")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"超大",prop:"oversize"}},[a("el-radio-group",{model:{value:e.newProduct.oversize,callback:function(t){e.$set(e.newProduct,"oversize",e._n(t))},expression:"newProduct.oversize"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("开启")]),e._v(" "),a("el-radio-button",{attrs:{label:"0"}},[e._v("关闭")])],1)],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"SKU",prop:"skuCode"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"使用全英文,空格用-号代替。如：gym-104"},model:{value:e.newProduct.skuCode,callback:function(t){e.$set(e.newProduct,"skuCode",t)},expression:"newProduct.skuCode"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"名称",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品名称"},model:{value:e.newProduct.name,callback:function(t){e.$set(e.newProduct,"name",t)},expression:"newProduct.name"}})],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"分类",prop:"categoryId"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"请选择分类,可筛选"},model:{value:e.newProduct.categoryId+"",callback:function(t){e.$set(e.newProduct,"categoryId + ''",t)},expression:"newProduct.categoryId + ''"}},e._l(e.categorySelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:e.openNewCategoryDialog}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"款式"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品款式"},model:{value:e.newProduct.groupName,callback:function(t){e.$set(e.newProduct,"groupName",t)},expression:"newProduct.groupName"}})],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"箱规",prop:"cartonSpecId"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"外箱包装材料规格,可筛选"},model:{value:e.newProduct.cartonSpecId+"",callback:function(t){e.$set(e.newProduct,"cartonSpecId+ ''",t)},expression:"newProduct.cartonSpecId+ ''"}},e._l(e.cartonspecSelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:e.openNewCartonspecDialog}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"装箱数",prop:"numberOfCarton"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"一箱有多少个产品"},model:{value:e.newProduct.numberOfCarton,callback:function(t){e.$set(e.newProduct,"numberOfCarton",t)},expression:"newProduct.numberOfCarton"}})],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"型号"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品型号"},model:{value:e.newProduct.model,callback:function(t){e.$set(e.newProduct,"model",t)},expression:"newProduct.model"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"颜色"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品颜色"},model:{value:e.newProduct.color,callback:function(t){e.$set(e.newProduct,"color",t)},expression:"newProduct.color"}})],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"净重(Kg)",prop:"grossWeight"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"单个商品的净重(不包括外箱重量)"},model:{value:e.newProduct.grossWeight,callback:function(t){e.$set(e.newProduct,"grossWeight",t)},expression:"newProduct.grossWeight"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"体积(Cm³ )"}},[a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"90px"},attrs:{placeholder:"长(Cm)"},model:{value:e.newProduct.length,callback:function(t){e.$set(e.newProduct,"length",t)},expression:"newProduct.length"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[e._v(" x")]),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"90px"},attrs:{placeholder:"宽(Cm)"},model:{value:e.newProduct.width,callback:function(t){e.$set(e.newProduct,"width",t)},expression:"newProduct.width"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[e._v(" x")]),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-input",{staticStyle:{width:"90px"},attrs:{placeholder:"高(Cm)"},model:{value:e.newProduct.height,callback:function(t){e.$set(e.newProduct,"height",t)},expression:"newProduct.height"}})],1)],1)],1)],1),e._v(" "),a("fieldset",{staticClass:"panel-heading",staticStyle:{"margin-top":"10px"}},[a("legend",{staticClass:"panel-title"},[e._v("采购信息")]),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"供货商",prop:"supplierId"}},[a("el-col",{attrs:{span:20}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",placeholder:"请选择供货商,可筛选"},model:{value:e.newProduct.supplierId+"",callback:function(t){e.$set(e.newProduct,"supplierId+ ''",t)},expression:"newProduct.supplierId+ ''"}},e._l(e.supplierSelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:e.openNewSupplierDialog}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"交期(天)"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品交期"},model:{value:e.newProduct.leadDay,callback:function(t){e.$set(e.newProduct,"leadDay",t)},expression:"newProduct.leadDay"}})],1)],1),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"结算货币",prop:"currencyId"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择结算货币"},model:{value:e.newProduct.currencyId+"",callback:function(t){e.$set(e.newProduct,"currencyId+ ''",t)},expression:"newProduct.currencyId+ ''"}},e._l(e.currencySelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"采购价",prop:"price"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品采购价格"},model:{value:e.newProduct.price,callback:function(t){e.$set(e.newProduct,"price",t)},expression:"newProduct.price"}})],1)],1)],1),e._v(" "),a("fieldset",{staticClass:"panel-heading",staticStyle:{"margin-top":"10px"}},[a("legend",{staticClass:"panel-title"},[e._v("销售信息")]),e._v(" "),a("el-row",[a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"FNSKU"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入产品FNSKU"},model:{value:e.newProduct.fnSku,callback:function(t){e.$set(e.newProduct,"fnSku",t)},expression:"newProduct.fnSku"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"},attrs:{label:"Vip级别"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入产品Vip级别"},model:{value:e.newProduct.vipLevel+"",callback:function(t){e.$set(e.newProduct,"vipLevel+ ''",t)},expression:"newProduct.vipLevel+ ''"}},e._l(e.currencySelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-row")],1),e._v(" "),a("fieldset",{staticClass:"panel-heading",staticStyle:{"margin-top":"10px"}},[a("legend",{staticClass:"panel-title"},[e._v("备注")]),e._v(" "),a("el-form-item",{staticStyle:{width:"400px"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{type:"textarea",autosize:{minRows:6,maxRows:10}},model:{value:e.newProduct.comment,callback:function(t){e.$set(e.newProduct,"comment",t)},expression:"newProduct.comment"}})],1)],1),e._v(" "),e.isNew?a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.onCreateProduct}},[e._v("立即创建\n      ")])],1):e._e()],1)],1)},r=[],i=(a("7f7f"),a("5256")),o=a("40801"),n=a("4946"),c=a("c405"),s=a("d186"),u=a("a6b9"),d=a("b9a9"),p={components:{},props:{init_data:{type:Object,default:null}},computed:{},data:function(){return{categorySelectOptions:[],cartonspecSelectOptions:[],supplierSelectOptions:[],currencySelectOptions:[],isNew:!this.init_data,confirmLoading:!1,newProduct:this.init_data?this.init_data:{status:1,skuCode:null,groupName:null,fnSku:null,categoryId:"",name:null,model:null,color:null,comment:null,grossWeight:null,length:null,width:null,height:null,supplierId:"",price:null,cartonSpecId:"",numberOfCarton:null,currencyId:"",leadDay:null,vipLevel:0,oversize:0},rules:{status:[{required:!0,message:"必须输入",trigger:"blur"}],skuCode:[{required:!0,message:"必须输入",trigger:"blur"}],name:[{required:!0,message:"必须输入",trigger:"blur"}],categoryId:[{required:!0,message:"必须输入",trigger:"blur"}],cartonSpecId:[{required:!0,message:"必须输入",trigger:"blur"}],numberOfCarton:[{required:!0,message:"必须输入",trigger:"blur"}],grossWeight:[],supplierId:[],currencyId:[],price:[]}}},created:function(){this.categorySelectOptions=c["a"].getMineSelectProdcutOptions(),this.cartonspecSelectOptions=s["a"].getSelectOptions(),this.supplierSelectOptions=u["a"].getSelectOptions(),this.currencySelectOptions=d["a"].getSelectOptions()},mounted:function(){},methods:{openNewCategoryDialog:function(){var e=this,t={title:"添加分类",component:i["a"],_width_:"70%",callback:function(t){e.categorySelectOptions.unshift({label:t.name,value:t.id+""}),e.newProduct.categoryId=t.id+""}};common.dialog(t)},openNewCartonspecDialog:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],{title:"添加箱规",component:o["a"],_width_:"70%",callback:function(t){e.cartonspecSelectOptions.unshift({label:t.name,value:t.id+""}),e.newProduct.cartonSpecId=t.id+""}});common.dialog(t)},openNewSupplierDialog:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],{title:"添加供货商",component:n["a"],_width_:"70%",callback:function(t){e.supplierSelectOptions.unshift({label:t.name,value:t.id+""}),e.newProduct.supplierId=t.id+""}});common.dialog(t)},onCreateProduct:function(){var e=this;this.$refs.createForm.validate(function(t){if(t){var a="/products";e.confirmLoading=!0,e.global.axios.post(a,e.newProduct).then(function(t){e.$message({type:"success",message:"产品添加成功"}),e.$refs.createForm.resetFields(),e.confirmLoading=!1}).catch(function(t){e.confirmLoading=!1})}})},confirm:function(){var e=this;this.$refs.createForm.validate(function(t){if(!t)return e.$emit("callback",null),!1;var a=e.newProduct;if(!a.id)return e.$message.error("无效的产品ID"),e.$emit("callback",null),!1;var l="/products/"+a.id;e.global.axios.put(l,a).then(function(t){e.$message({type:"success",message:"商品编辑成功"});var a=t.data;e.$emit("callback",{type:"sure",data:a})}).catch(function(t){e.$emit("callback",null)})})}}},h=p,m=(a("e093"),a("2877")),f=Object(m["a"])(h,l,r,!1,null,"1a204be3",null);t["default"]=f.exports},"55dd":function(e,t,a){"use strict";var l=a("5ca1"),r=a("d8e8"),i=a("4bf8"),o=a("79e5"),n=[].sort,c=[1,2,3];l(l.P+l.F*(o(function(){c.sort(void 0)})||!o(function(){c.sort(null)})||!a("2f21")(n)),"Array",{sort:function(e){return void 0===e?n.call(i(this)):n.call(i(this),r(e))}})},bec3:function(e,t,a){"use strict";var l=a("2d66"),r=a.n(l);r.a},e093:function(e,t,a){"use strict";var l=a("27dd"),r=a.n(l);r.a},e2dd:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ph-table"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.productParam,id:"filter-form"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择分类"},model:{value:e.productParam.categoryId.value,callback:function(t){e.$set(e.productParam.categoryId,"value",t)},expression:"productParam.categoryId.value"}},e._l(e.categorySelectOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"SKU"}},[a("el-input",{attrs:{placeholder:"请输入SKU"},model:{value:e.productParam.skuCode.value,callback:function(t){e.$set(e.productParam.skuCode,"value",t)},expression:"productParam.skuCode.value"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.productParam.name.value,callback:function(t){e.$set(e.productParam.name,"value",t)},expression:"productParam.name.value"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{"native-type":"submit",type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"",border:"","highlight-current-row":"","row-class-name":e.dangerClassName,"cell-class-name":"ph-cell","header-cell-class-name":"ph-cell-header",data:e.data,"max-height":e.tableMaxHeight,id:"table"},on:{"selection-change":e.handleSelectionChange,"sort-change":e.handleSortChange,"filter-change":e.handleFilterChange}},[a("el-table-column",{attrs:{prop:"skuCode",sortable:"custom",label:"SKU","min-width":"150",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"category.name",label:"分类",width:"80"}}),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"groupName",label:"款式",width:"80"}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"model",label:"型号","min-width":"120"}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"color",label:"颜色","min-width":"120"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"grossWeight",label:"净重(Kg)",sortable:"custom",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"length",label:"长(Cm)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"width",label:"宽(Cm)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"height",label:"高(Cm)",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"volume",label:"体积(Cm³)",sortable:"custom",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"supplier.name",label:"供货商","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"currencyName",label:"结算货币","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"采购价",sortable:"custom","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cartonSpec.code",label:"箱规","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"numberOfCarton",label:"装箱数",width:"100"}}),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"asin",label:"ASIN","min-width":"120"}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"fnSku",label:"FN-SKU","min-width":"120"}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"parentSku",label:"Parent Asin","min-width":"120"}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"vipLevel",label:"Vip级别","min-width":"100",formatter:e.vipLevelFormatter}}):e._e(),e._v(" "),e.unfinishedHide?a("el-table-column",{attrs:{prop:"oversize",label:"超大","min-width":"100",formatter:function(e){return 1===e.oversize?"是":"否"}}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.status?"success":"info","disable-transitions":""}},[e._v(e._s(1===t.row.status?"启用":"禁用")+"\n        ")])]}}])}),e._v(" "),e.hasOperation?a("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasEdit?a("el-button",{attrs:{size:"small",icon:"el-icon-edit",circle:"",type:"primary",id:"ph-table-edit"},on:{click:function(a){return e.onDefaultEdit(t.row)}}}):e._e(),e._v(" "),e.hasDelete?a("el-button",{attrs:{type:"danger",size:"mini",id:"ph-table-del",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.onDefaultDelete(t.row)}}}):e._e()]}}],null,!1,277848559)}):e._e()],1),e._v(" "),a("el-pagination",{ref:"pageForm",staticStyle:{"text-align":"right",padding:"10px 0"},attrs:{"current-page":e.page,"page-sizes":e.paginationSizes,"page-size":e.size,total:e.total,background:"",layout:e.layout,id:"ph-table-page"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("el-button",{staticClass:"btn-prev",attrs:{icon:"el-icon-refresh",circle:""},on:{click:e.onRefreshTable}})],1)],1)},r=[],i=(a("386d"),a("6b54"),a("456d"),a("ac6a"),a("7f7f"),a("55dd"),a("a481"),a("4917"),a("cebc")),o=(a("3b2b"),a("c832"),a("2f62")),n=a("4328"),c=a.n(n),s=a("c405"),u=a("3514"),d="~",p=new RegExp(d,"g"),h=",",m="=",f=/=/g,g="q=",v=new RegExp("q=.*"+h),b={components:{createFrom:u["default"]},props:{type:{type:String,default:"valid"},defaultFilters:{type:Object,default:{}}},computed:Object(i["a"])({},Object(o["b"])(["device","rolePower","rolePower"]),{phTableAttrs:function(){return Object.assign(this.defaultTableAttrs,this.tableAttrs)},unfinishedHide:function(){return"unfinished"!==this.type}}),data:function(){return{tableMaxHeight:"mobile"!==this.device?400:4e7,hasOperation:!0,hasEdit:!0,hasDelete:!0,selected:[],size:20,page:1,layout:"total, sizes, slot, prev, pager, next, jumper",paginationSizes:[20,50,100],total:0,url:"unfinished"===this.type?"/products/unfinishs":"/products",countUrl:"unfinished"===this.type?"/products/countUnfinishs":"/products/count",relations:["category","supplier","cartonSpec","currency"],data:[],phSort:{prop:"skuCode",order:"asc"},loading:!1,categorySelectOptions:[],productParam:{categoryId:{value:null,op:"eq",id:"categoryId"},skuCode:{value:null,op:"bw",id:"skuCode"},name:{value:null,op:"bw",id:"name"}},dialogTitle:"新增",dialogVisible:!1,isNew:!0,isEdit:!1,isView:!1,confirmLoading:!1,row:{}}},created:function(){this.categorySelectOptions=s["a"].getMineSelectProdcutOptions()},mounted:function(){var e=this;window.onresize=function(){e.getTableHeight()};var t=location.href.match(v);if(t){var a=t[0].substr(2).replace(p,m),l=c.a.parse(a,{delimiter:h});this.page=l.currentPage?1*l.currentPage:this.page,this.size=l.pageSize?1*l.pageSize:this.size,this.phSort.prop=l.sort?l.sort:this.phSort.prop,this.phSort.order=l.dir?l.dir:this.phSort.order,l.categoryId&&(this.productParam.categoryId.value=l.categoryId),l.skuCode&&(this.productParam.skuCode.value=l.skuCode),l.name&&(this.productParam.name.value=l.name)}this.$nextTick(function(){e.getTableHeight(),e.getList()})},methods:{getTableHeight:function(){if("mobile"!==this.device){var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=e;t-=84,t-=82,t-=this.$refs.searchForm?this.$refs.searchForm.$el.offsetHeight:0,t-=this.$refs.operationForm?this.$refs.operationForm.$el.offsetHeight:0,t-=this.$refs.pageForm?this.$refs.pageForm.$el.offsetHeight:0,t-=42,this.tableMaxHeight=t}else this.tableMaxHeight=400},getList:function(e){var t=this,a=this.url,l=this.countUrl,r="",i="",o=this.size,n=this.page;if(a){a.indexOf("?")>-1?a+="&":a+="?",l.indexOf("?")>-1?l+="&":l+="?",r+="pageSize=".concat(o,"&currentPage=").concat(n),i+="pageSize=".concat(o,"&currentPage=").concat(n),this.phSort&&(r+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order),i+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order));var c=[];if(Object.keys(this.productParam).filter(function(e){return t.productParam[e]&&""!==t.productParam[e].value&&null!==t.productParam[e].value&&void 0!==t.productParam[e].value}).forEach(function(e){c.push({field:e,op:t.productParam[e].op?t.productParam[e].op:"eq",data:t.productParam[e].value?encodeURIComponent(t.productParam[e].value.toString().trim()):""})}),c.forEach(function(e,t){i+="&"+e.field+"="+encodeURIComponent(e.data?e.data.toString().trim():"")}),c.push(JSON.parse(JSON.stringify(this.defaultFilters))),c&&c.length>0&&(r+="&filters="+JSON.stringify({groupOp:"AND",rules:c})),this.relations&&this.relations.length>0&&(r+="&relations="+JSON.stringify(this.relations)),this.loading=!0,this.global.axios.get(l+r).then(function(e){var a=e.data;t.total=a||0}).catch(function(e){}),this.global.axios.get(a+r).then(function(e){var a=e.data,l=a||[];t.data=l,t.loading=!1,t.$emit("update",l,a)}).catch(function(e){t.$emit("error",e),t.loading=!1}),e>0){var s="",u=g+i.replace(/&/g,h).replace(f,d)+h;if(location.href.indexOf(g)>-1)s=location.href.replace(v,u);else{var p=location.hash.indexOf("?")>-1?"&".concat(u):"?".concat(u);s=location.origin+location.pathname+location.search+location.hash+p}history.pushState(history.state,"ph-table search",s)}}else console.warn("url 为空, 不发送请求")},search:function(){var e=this;this.$refs.searchForm.validate(function(t){t&&(e.page=1,e.getList(!0))})},resetSearch:function(){var e=this;this.$refs.searchForm.resetFields(),this.productParam.categoryId.value=null,this.productParam.skuCode.value=null,this.productParam.name.value=null,this.page=1,history.replaceState(history.state,"",location.href.replace(v,"")),this.$nextTick(function(){e.getList()}),this.$emit("reset"),this.$emit("update:customQuery",Object.assign(this.customQuery,JSON.parse(this.initCustomQuery)))},vipLevelFormatter:function(e,t){return 0===e.vipLevel?"0-普通":1===e.vipLevel?"1-热销":2===e.vipLevel?"2-爆款":e.vipLevel},dangerClassName:function(e){var t=e.row;return null==t.categoryId||""==t.categoryId?"danger-row":null==t.supplierId||""==t.supplierId?"danger-row":null==t.numberOfCarton||""==t.numberOfCarton?"danger-row":null==t.cartonSpecId||""==t.cartonSpecId||-1==t.cartonSpecId?"danger-row":null==t.grossWeight||""==t.grossWeight||t.grossWeight<=0?"danger-row":!t.price&&(""==t.price||t.price<=0)?"danger-row":""},handleSizeChange:function(e){this.size!==e&&(this.page=1,this.size=e,this.getList(!0))},handleCurrentChange:function(e){this.page!==e&&(this.page=e,this.getList(!0))},handleSelectionChange:function(e){this.selected=e,this.$emit("selection-change",e)},handleSortChange:function(e){e.prop&&(this.phSort.prop=e.prop,this.phSort.order="ascending"===e.order?"asc":"desc"),this.page=1,this.getList(!0)},handleFilterChange:function(e){for(var t in e)t,e[t]},onDefaultEdit:function(e){var t=this,a="/products/"+e.id;this.relations&&this.relations.length>0&&(a+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(a).then(function(e){var a={title:"编辑产品",component:u["default"],_top_:"3vh",_width_:"90%",data:e.data,callback:function(e){e&&t.getList()}};common.dialog(a)}).catch(function(e){})},cancel:function(){},confirm:function(){},onRefreshTable:function(){this.getList()}}},w=b,y=(a("bec3"),a("2877")),S=Object(y["a"])(w,l,r,!1,null,"4424415c",null);t["default"]=S.exports}}]);