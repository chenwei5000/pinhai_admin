(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fddef1d2","chunk-213f78a6","chunk-0020738e"],{"5128d":function(t,e,i){},6638:function(t,e,i){"use strict";var a=i("c067"),n=i.n(a);n.a},"6ab9":function(t,e,i){"use strict";var a=i("9451"),n=i.n(a);n.a},9451:function(t,e,i){},a4de:function(t,e,i){"use strict";var a=i("5128d"),n=i.n(a);n.a},acb1:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-upload",{staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-preview":t.handlePreview,"before-remove":t.beforeRemove,"on-success":t.handleSuccess,multiple:"","file-list":t.attachments}},[i("el-button",{staticClass:"button-new-tag"},[t._v("+ 添加附件")])],1)],1)},n=[],o=(i("7f7f"),i("ac6a"),i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{uploadUrl:function(){return"".concat(this.global.generateUrl(this.url),"/uploadFiles/").concat(this.primary.id,"?accessToken=").concat(this.$store.state.user.token)}},data:function(){return{url:"/attachments/procurementPlan",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.primary){var e=this.url;this.filters&&this.filters.length>0&&(e+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(e+="&relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data,a=i||[];t.attachments=[],a.forEach(function(e){t.attachments.push({id:e.id,name:e.fileName,url:"".concat(t.global.generateUrl(t.url),"/view/").concat(e.id,"?accessToken=").concat(t.$store.state.user.token)})})}).catch(function(t){})}},remove:function(t){var e=this;if(this.primary){var i="".concat(this.global.generateUrl(this.url),"/").concat(t.id,"?accessToken=").concat(this.$store.state.user.token);this.global.axios.delete(i).then(function(t){e.$message.info("附件删除成功!")}).catch(function(t){})}},handleSuccess:function(){this.initData()},handlePreview:function(t){window.open(t.url,"_blank")},beforeRemove:function(t,e){var i=this;return this.$confirm("确定移除 ".concat(t.name,"？"),"提示",{beforeClose:function(e,a,n){"confirm"==e?(i.remove(t),n(!0)):n(!1)}})}}}),s=o,r=(i("6ab9"),i("2877")),c=Object(r["a"])(s,a,n,!1,null,"1481a50c",null);e["default"]=c.exports},bc3f:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"editObject",attrs:{rules:t.rules,model:t.editObject,"status-icon":"",inline:"","label-position":"right","label-width":"120px"}},[i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"发货计划编码",prop:"code"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",placeholder:"请填写编码",clearable:""},model:{value:t.editObject.code,callback:function(e){t.$set(t.editObject,"code",e)},expression:"editObject.code"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"发货厂商",prop:"supplierId"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请填写编码",clearable:""},model:{value:t.editObject.supplier.name,callback:function(e){t.$set(t.editObject.supplier,"name",e)},expression:"editObject.supplier.name"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"收货仓库",prop:"warehouseId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"请选择",change:t.warehouseChange()},model:{value:t.editObject.warehouse.name,callback:function(e){t.$set(t.editObject.warehouse,"name",e)},expression:"editObject.warehouse.name"}},t._l(t.warehouseSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"预计发货时间",prop:"expectTime"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd",type:"date",placeholder:"交货截止日"},model:{value:t.editObject.expectTime,callback:function(e){t.$set(t.editObject,"expectTime",e)},expression:"editObject.expectTime"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-form-item",{attrs:{label:"备注",prop:"note"}},[i("el-col",{attrs:{span:22}},[i("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:"3",cols:"80","show-word-limit":""},model:{value:t.editObject.note,callback:function(e){t.$set(t.editObject,"note",e)},expression:"editObject.note"}})],1),t._v(" "),i("el-col",{attrs:{span:2}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"备注信息。支持换行！",placement:"right"}},[i("i",{staticClass:"el-icon-question"},[t._v(" ")])])],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.onSave}},[t._v("\n          保存基本信息\n        ")])],1)],1)],1)],1)},n=[],o=(i("7f7f"),i("ac6a"),i("c405")),s=i("64dc"),r=i("8492"),c=i("8593"),l=(i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{},data:function(){return{loading:!1,confirmLoading:!1,warehouseSelectOptions:[],editObject:{},rules:{code:[{required:!0,message:"必须输入",trigger:"blur"}],supplierId:[{required:!0,message:"必须输入",trigger:"blur"}],warehouseId:[{required:!0,message:"必须输入",trigger:"blur"}]}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.loading=!0,this.primary){this.editObject=this.primary,this.editObject.limitTime=this.primary.formatLimitTime,this.editObject.executeTime=this.primary.formatExecuteTime,this.categorySelectOptions=o["a"].getMineSelectOptions(),this.merchantSelectOptions=r["a"].getSelectOptions(),this.warehouseSelectOptions=s["a"].getSelectDomesticOptions(),c["a"].getConfigInfos().then(function(e){null==t.editObject.safetyStockWeek&&(t.editObject.safetyStockWeek=e.safetyStockWeek),null==t.editObject.vip1SafetyStockWeek&&(t.editObject.vip1SafetyStockWeek=e.vip1SafetyStockWeek),null==t.editObject.vip2SafetyStockWeek&&(t.editObject.vip2SafetyStockWeek=e.vip2SafetyStockWeek)});var e=!0;this.warehouseSelectOptions.forEach(function(t){"-99"==t.value&&(e=!1)}),e&&this.warehouseSelectOptions.unshift({label:"供货商库存",value:"-99"}),this.loading=!1}else this.$message.error("无效的采购计划!"),this.loading=!1},onSave:function(){var t=this;this.$confirm("注意保存基本信息只会修改对应的参数，不会重新计算明细数据，您是否继续？","提示",{type:"warning",beforeClose:function(e,i,a){"confirm"==e?(a(),t.modifyObject()):a()}}).catch(function(t){})},modifyObject:function(){var t=this,e=JSON.parse(JSON.stringify(this.editObject));this.editObject.warehouseId=this.editObject.warehouse.name,this.loading=!0,this.confirmLoading=!0,this.global.axios.put("/procurementShippedOrders/".concat(this.editObject.id),e).then(function(e){var i=e.data;t.$message({type:"success",message:"操作成功"}),t.loading=!1,t.confirmLoading=!1,t.formVisible=!1,t.$emit("modifyCBEvent",i)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})},warehouseChange:function(){this.editObject.warehouseId=this.editObject.warehouse.name}}}),u=l,d=(i("a4de"),i("2877")),m=Object(d["a"])(u,a,n,!1,null,"ff77f0f6",null);e["default"]=m.exports},c067:function(t,e,i){},fca1:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogVisible?i("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,fullscreen:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-row",{staticStyle:{"margin-bottom":"20px"}},[1==t.primary.status?i("el-button",{attrs:{type:"primary",icon:"el-icon-s-check"},on:{click:t.onCommit}},[t._v("提交审核")]):t._e(),t._v(" "),0==t.primary.status?i("el-button",{attrs:{type:"success",icon:"el-icon-success"},on:{click:t.onAgree}},[t._v("同意")]):t._e(),t._v(" "),0==t.primary.status?i("el-button",{attrs:{type:"warning",icon:"el-icon-error"},on:{click:t.onRefuse}},[t._v("不同意")]):t._e(),t._v(" "),1!=t.primary.status?i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-left"},on:{click:t.onWithdraw}},[t._v("撤回\n    ")]):t._e(),t._v(" "),t.hasExecute?i("el-button",{attrs:{type:"success",icon:"el-icon-s-claim"},on:{click:t.onComplete}},[t._v("结束计划")]):t._e(),t._v(" "),t.hasExecute?i("el-button",{attrs:{type:"primary",icon:"el-icon-user-solid"},on:{click:t.onAssign}},[t._v("指派处理人")]):t._e(),t._v(" "),t.hasExecute?i("el-button",{attrs:{type:"primary",icon:"el-icon-s-goods"},on:{click:t.onHandover}},[t._v("交接工作")]):t._e(),t._v(" "),t.hasExecute?i("el-button",{attrs:{type:"primary",icon:"el-icon-share"},on:{click:t.onShare}},[t._v("分享")]):t._e()],1),t._v(" "),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"infoFrom"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("1. 基本信息")]),t._v(" "),i("infoFrom",{ref:"infoFrom",attrs:{primary:t.primary},on:{modifyCBEvent:t.modifyCBEvent}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"itemTable"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("2. 发货计划内容")]),t._v(" "),i("itemTable",{ref:"itemTable",attrs:{primary:t.primary}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"attachment"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("3. 附件")]),t._v(" "),i("attachment",{ref:"attachment",attrs:{primary:t.primary}})],1)],1)],1):t._e()},n=[],o=(i("7f7f"),i("bc3f")),s=i("7670"),r=i("acb1"),c={components:{infoFrom:o["default"],itemTable:s["default"],attachment:r["default"]},props:{},computed:{hasExecute:function(){return[2,3,4,5,6,7].indexOf(this.primary.status)>-1},title:function(){return"编辑发货计划 ["+this.primary.name+"] -- ("+this.primary.statusName+"状态)"}},data:function(){return{primaryId:null,primary:{},dialogVisible:!1,activeNames:[],relations:["supplier","warehouse"],url:"/procurementShippedOrders"}},created:function(){},mounted:function(){this.$nextTick(function(){})},methods:{initData:function(){var t=this;if(this.primaryId){var e="".concat(this.url,"/").concat(this.primaryId);this.relations&&this.relations.length>0&&(e+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data;t.primary=i||{},t.dialogVisible=!0}).catch(function(t){})}},openDialog:function(t){this.primaryId=t,this.initData()},modifyCBEvent:function(t){this.$emit("modifyCBEvent",t)},onCommit:function(){},onAgree:function(){},onRefuse:function(){},onWithdraw:function(){},onAssign:function(){},onHandover:function(){},onShare:function(){},onComplete:function(){}}},l=c,u=(i("6638"),i("2877")),d=Object(u["a"])(l,a,n,!1,null,"108182df",null);e["default"]=d.exports}}]);