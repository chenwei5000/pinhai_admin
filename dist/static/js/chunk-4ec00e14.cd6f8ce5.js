(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ec00e14","chunk-2d22cc88"],{"223e":function(t,e,a){"use strict";var l=a("a5c1"),i=a.n(l);i.a},a5c1:function(t,e,a){},b76e:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ph-table"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchParam,id:"filter-form"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"SKU"}},[a("el-input",{attrs:{placeholder:"请输入SKU",clearable:""},model:{value:t.searchParam.skuCode,callback:function(e){t.$set(t.searchParam,"skuCode",e)},expression:"searchParam.skuCode"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{"native-type":"submit",type:"primary",size:"small"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1),t._v(" "),a("tableToolBar",t._b({on:{onToolBarAdd:t.onToolBarAdd,onToolBarEdit:t.onToolBarEdit,onToolBarDelete:t.onToolBarDelete,onToolBarDownloadTpl:t.onToolBarDownloadTpl,onToolBarDownloadData:t.onToolBarDownloadData,onToolBarImportData:t.onToolBarImportData}},"tableToolBar",t.toolbarConfig,!1)),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"",border:"","highlight-current-row":"","max-height":t.tableMaxHeight,"row-class-name":t.dangerClassName,"cell-class-name":"ph-cell","header-cell-class-name":"ph-cell-header",data:t.tableData,"show-summary":"","summary-method":t.getSummaries,"default-sort":{prop:"product.skuCode",order:"ascending"},id:"table"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"sortNum",label:"序号",sortable:"",width:"200",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statusName",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:0===e.row.status?"warning":3===e.row.status?"primary":6===e.row.status?"info":"success","disable-transitions":""}},[t._v(t._s(e.row.statusName)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"skuCode",label:"SKU编码",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"product.name",label:"产品名",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"boxCode",label:"箱码",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"shippedCartonQty",label:"发货数量(箱)",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"storageLocation.code",label:"存放货位",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"shippedQty",label:"总发货件数",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"receivedQty",label:"收货数量",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{prop:"receivedNote",sortable:"",label:"异常备注",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"receivedCartonQty",sortable:"",label:"合计箱数",width:"120"}}),t._v(" "),t.hasOperation?a("el-table-column",{attrs:{label:"操作","no-export":"true",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasEdit?a("el-button",{attrs:{size:"small",icon:"el-icon-edit",circle:"",type:"primary",id:"ph-table-edit"},on:{click:function(a){return t.onDefaultEdit(e.row)}}}):t._e()]}}],null,!1,2159769287)}):t._e()],1),t._v(" "),a("itemDialog",{ref:"itemDialog",attrs:{primaryId:t.primary.id},on:{modifyCBEvent:t.modifyCBEvent}})],1)},i=[],o=(a("7f7f"),a("386d"),a("c5f6"),a("ac6a"),a("cebc")),r=a("2f62"),n=a("ed08"),s=a("a4af"),d=a("c971"),c=a("f569"),u={components:{tableToolBar:s["a"],itemDialog:c["default"]},props:{primary:{type:[Object],default:null}},computed:Object(o["a"])({},Object(r["b"])(["device","rolePower"])),filters:{currency:n["b"]},data:function(){return{statusSelectOptions:[],tableMaxHeight:"mobile"!==this.device?500:4e7,confirmLoading:!1,hasOperation:!0,hasAdd:!1,hasEdit:!0,hasDelete:!1,selected:[],url:"/procurementReceivedOrderItems",downloadUrl:"",searchParam:{skuCode:null},filters:[{field:"procurementShippedOrderId",op:"eq",data:this.primary?this.primary.id:-1}],relations:["product","cartonSpec","procurementShippedOrder","procurementOrderItem","storageLocation"],data:[],tableData:[],loading:!1,row:{},toolbarConfig:{hasEdit:!0,hasDelete:!1,hasAdd:!1,hasExportTpl:!1,hasExport:!1,hasImport:!1}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData(),t.getList()})},methods:{initData:function(){this.loading=!0,this.statusSelectOptions=d["a"].getSelectOptions("ProcurementShippedOrderStatus"),this.downloadUrl=this.url,this.filters&&this.filters.length>0&&(this.downloadUrl+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(this.downloadUrl+="&relations="+JSON.stringify(this.relations))},dangerClassName:function(t){t.row},getSummaries:function(t){var e=t.columns,a=t.data,l=[];return e.forEach(function(t,e){if("product.skuCode"==t.property){var i=a.map(function(e){return e[t.property]});l[e]=i.reduce(function(t){return t+1},0),l[e]="合计: "+l[e]+" 行"}if("cartonQty"==t.property){var o=a.map(function(e){return Number(e[t.property])});o.every(function(t){return isNaN(t)})?l[e]="N/A":(l[e]=o.reduce(function(t,e){var a=Number(e);return isNaN(a)?t:t+e},0),l[e]+=" 箱")}if("amount"==t.property){var r=a.map(function(e){return Number(e[t.property])});r.every(function(t){return isNaN(t)})?l[e]="N/A":(l[e]=r.reduce(function(t,e){var a=Number(e);return isNaN(a)?t:t+e},0),l[e]=Object(n["b"])(l[e]))}}),l},getList:function(){var t=this,e=this.url,a="";e?(this.filters&&this.filters.length>0&&(a+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(a+="&relations="+JSON.stringify(this.relations)),this.loading=!0,this.global.axios.get(e+a).then(function(e){var a=e.data,l=a||[];t.data=l,t.search(),t.total=a.length||0,t.loading=!1,t.$emit("update",l,a)}).catch(function(e){t.$emit("error",e),t.loading=!1})):console.warn("url 为空, 不发送请求")},handleSelectionChange:function(t){this.selected=t},search:function(){var t=this;this.tableData=this.data,null!=this.searchParam.category&&""!=this.searchParam.category&&(this.tableData=this.tableData.filter(function(e){if(e.product&&e.product.category&&-1!==e.product.category.name.indexOf(t.searchParam.category))return!0})),null!=this.searchParam.skuCode&&""!=this.searchParam.skuCode&&(this.tableData=this.tableData.filter(function(e){if(e.product&&-1!==e.product.skuCode.indexOf(t.searchParam.skuCode))return!0})),null!=this.searchParam.status&&""!=this.searchParam.status&&(this.tableData=this.tableData.filter(function(e){if(e.status==t.searchParam.status)return!0})),null!=this.searchParam.priority&&""!=this.searchParam.priority&&(this.tableData=this.tableData.filter(function(e){if(e.priority==t.searchParam.priority)return!0}))},resetSearch:function(){this.$refs.searchForm.resetFields(),this.searchParam.skuCode=null,this.search()},onDefaultEdit:function(t){this.$refs.itemDialog.openDialog(t.id)},onDefaultDelete:function(t){var e=this;this.$confirm("确认删除吗","提示",{type:"warning",beforeClose:function(t,a,l){"confirm"==t?(e.getList(),l()):l()}}).catch(function(t){})},modifyCBEvent:function(t){this.getList()},onToolBarAdd:function(){this.$refs.itemDialog.openDialog(null)},onToolBarEdit:function(){},onToolBarDelete:function(){},onToolBarDownloadTpl:function(){var t=this.$refs.table,e=this.downloadUrl;Promise.all([a.e("chunk-d2907d8a"),a.e("chunk-748b566e")]).then(a.bind(null,"4bf8d")).then(function(a){a.export_el_table_to_excel({table:t,downloadUrl:e,filename:"采购计划内容-模版",noExportProps:["操作","金额","ID","下单件数","发货件数","收货件数"],tpl:!0})})},onToolBarDownloadData:function(){var t=this,e=this.$refs.table,l=this.downloadUrl;Promise.all([a.e("chunk-d2907d8a"),a.e("chunk-748b566e")]).then(a.bind(null,"4bf8d")).then(function(a){t.loading=!0,a.export_el_table_to_excel({table:e,downloadUrl:l,filename:"采购计划内容",noExportProps:["操作","金额","ID"]}),t.loading=!1})},onToolBarImportData:function(){}}},p=u,m=(a("223e"),a("2877")),h=Object(m["a"])(p,l,i,!1,null,"2fa973e4",null);e["default"]=h.exports},f569:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dialogVisible?a("el-dialog",{attrs:{title:t.dialogTitle,"append-to-body":"",width:"80%",top:"20px",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"detailItem",attrs:{rules:t.rules,model:t.detailItem,"status-icon":"",inline:"","label-position":"right","label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"序号",prop:"sortNum"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.sortNum,callback:function(e){t.$set(t.detailItem,"sortNum",e)},expression:"detailItem.sortNum"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"SKU编码",prop:"skuCode"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.skuCode,callback:function(e){t.$set(t.detailItem,"skuCode",e)},expression:"detailItem.skuCode"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"箱码",prop:"boxCode"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.boxCode,callback:function(e){t.$set(t.detailItem,"boxCode",e)},expression:"detailItem.boxCode"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"产品名",prop:"productId"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.productId,callback:function(e){t.$set(t.detailItem,"productId",e)},expression:"detailItem.productId"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"发货数量(箱)",prop:"shippedCartonQty"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.shippedCartonQty,callback:function(e){t.$set(t.detailItem,"shippedCartonQty",e)},expression:"detailItem.shippedCartonQty"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"存放货位",prop:"storageLocationId"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.storageLocationId,callback:function(e){t.$set(t.detailItem,"storageLocationId",e)},expression:"detailItem.storageLocationId"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"总发货件数",prop:"shippedQty"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.shippedQty,callback:function(e){t.$set(t.detailItem,"shippedQty",e)},expression:"detailItem.shippedQty"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"收货数量",prop:"receivedQty"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:t.detailItem.receivedQty,callback:function(e){t.$set(t.detailItem,"receivedQty",e)},expression:"detailItem.receivedQty"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"异常备注",prop:"receivedNote"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:t.detailItem.receivedNote,callback:function(e){t.$set(t.detailItem,"receivedNote",e)},expression:"detailItem.receivedNote"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:10}},[a("el-form-item",{attrs:{label:"合计箱数",prop:"receivedCartonQty"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.detailItem.receivedCartonQty,callback:function(e){t.$set(t.detailItem,"receivedCartonQty",e)},expression:"detailItem.receivedCartonQty"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{md:24}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.onSave}},[t._v("\n            保存\n          ")])],1)],1)],1)],1)],1):t._e()},i=[],o=(a("c5f6"),{components:{},props:{primaryId:{type:Number,default:null}},computed:{dialogTitle:function(){return null==this.detailItemId?"添加采购入库明细":"修改采购入库明细"}},data:function(){return{dialogVisible:!1,loading:!1,confirmLoading:!1,url:"/procurementReceivedOrderItems",relations:["product","cartonSpec","procurementShippedOrder","procurementOrderItem","storageLocation"],detailItemId:null,detailItem:{sortNum:null,skuCode:null,boxCode:null,shippedCartonQty:null,storageLocationId:null,shippedQty:null,receivedQty:null,receivedNote:null,receivedCartonQty:null,productId:null},rules:{}}},created:function(){},mounted:function(){this.$nextTick(function(){})},methods:{initData:function(){var t=this;if(this.detailItemId){this.loading=!0;var e="".concat(this.url,"/").concat(this.detailItemId);this.relations&&this.relations.length>0&&(e+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var a=e.data,l=a||{};t.detailItem=l,t.detailItem.storageLocationId=t.detailItem.storageLocationId+"",t.detailItem.productId=t.detailItem.productId+"",t.loading=!1})}},openDialog:function(t){this.detailItemId=t,this.dialogVisible=!0,this.initData()},onSave:function(){var t=this;this.$refs.detailItem.validate(function(e){if(!e)return!1;t.loading=!0,t.confirmLoading=!0;var a="post",l=t.url+"";t.detailItemId&&t.detailItemId>0&&(a="put",l="".concat(t.url,"/").concat(t.detailItemId));var i=JSON.parse(JSON.stringify(t.detailItem));t.global.axios[a](l,i).then(function(e){t.$message.info("修改成功"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})})}}}),r=o,n=a("2877"),s=Object(n["a"])(r,l,i,!1,null,"2016f3ed",null);e["default"]=s.exports}}]);