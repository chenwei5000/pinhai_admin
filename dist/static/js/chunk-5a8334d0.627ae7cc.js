(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a8334d0"],{"2f21":function(t,e,a){"use strict";var i=a("79e5");t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},"3ade":function(t,e,a){},"55dd":function(t,e,a){"use strict";var i=a("5ca1"),n=a("d8e8"),r=a("4bf8"),s=a("79e5"),o=[].sort,l=[1,2,3];i(i.P+i.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!a("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(r(this)):o.call(r(this),n(t))}})},7287:function(t,e,a){"use strict";var i=a("3ade"),n=a.n(i);n.a},a4b0:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ph-table"},[a("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.searchParam,id:"filter-form"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:t.searchParam.name.value,callback:function(e){t.$set(t.searchParam.name,"value",e)},expression:"searchParam.name.value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.searchParam.status.value,callback:function(e){t.$set(t.searchParam.status,"value",e)},expression:"searchParam.status.value"}},[a("el-option",{attrs:{label:"开启",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"关闭",value:"0"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{"native-type":"submit",type:"primary",size:"small"},on:{click:t.search}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{stripe:"",border:"","highlight-current-row":"","row-class-name":t.dangerClassName,"cell-style":{padding:"2px 0","font-size":"13px"},"header-cell-style":{padding:"2px 0"},data:t.data,"max-height":t.tableMaxHeight,id:"table"},on:{"selection-change":t.handleSelectionChange,"sort-change":t.handleSortChange,"filter-change":t.handleFilterChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"100",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"250",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:1===e.row.status?"success":"info","disable-transitions":""}},[t._v(t._s(1===e.row.status?"启用":"关闭")+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"formatLastModified",label:"修改时间",width:"150",fixed:"left"}}),t._v(" "),t.hasOperation?a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.hasEdit?a("el-button",{attrs:{size:"mini",icon:"el-icon-edit",circle:"",type:"primary",id:"ph-table-edit"},on:{click:function(a){return t.onDefaultEdit(e.row)}}}):t._e(),t._v(" "),t.hasDelete?a("el-button",{attrs:{type:"danger",size:"mini",id:"ph-table-del",icon:"el-icon-delete",circle:""},on:{click:function(a){return t.onDefaultDelete(e.row)}}}):t._e(),t._v(" "),t.hasSetting?a("el-button",{attrs:{type:"warning",size:"mini",id:"ph-table-setting",icon:"el-icon-setting",circle:""},on:{click:function(a){return t.onDefaultSetting(e.row)}}}):t._e()]}}],null,!1,2777522398)}):t._e()],1),t._v(" "),a("el-pagination",{ref:"pageForm",staticStyle:{"text-align":"right",padding:"10px 0"},attrs:{"current-page":t.page,"page-sizes":t.paginationSizes,"page-size":t.size,total:t.total,background:"",layout:t.layout,id:"ph-table-page"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("el-button",{staticClass:"btn-prev",attrs:{icon:"el-icon-refresh",circle:""},on:{click:t.onRefreshTable}})],1)],1)},n=[],r=(a("386d"),a("6b54"),a("456d"),a("ac6a"),a("7f7f"),a("55dd"),a("a481"),a("4917"),a("cebc")),s=(a("3b2b"),a("2f62")),o=a("4328"),l=a.n(o),c="~",h=new RegExp(c,"g"),u=",",d="=",p=/=/g,f="q=",g=new RegExp("q=.*"+u),m={components:{},props:{},computed:Object(r["a"])({},Object(s["b"])(["device"]),{phTableAttrs:function(){return Object.assign(this.defaultTableAttrs,this.tableAttrs)}}),data:function(){return{tableMaxHeight:"mobile"!==this.device?400:4e7,hasOperation:!0,hasEdit:!0,hasDelete:!0,hasSetting:!0,selected:[],size:20,page:1,layout:"total, sizes, slot, prev, pager, next, jumper",paginationSizes:[20,50,100],total:0,url:"/roles",countUrl:"/roles/count",relations:[],data:[],phSort:{prop:"id",order:"asc"},loading:!1,searchParam:{name:{value:null,op:"bw",id:"name"},status:{value:null,op:"eq",id:"status"}},dialogTitle:"新增",dialogVisible:!1,isNew:!0,isEdit:!1,isView:!1,confirmLoading:!1,row:{}}},created:function(){},mounted:function(){var t=this;window.onresize=function(){t.getTableHeight()};var e=location.href.match(g);if(e){var a=e[0].substr(2).replace(h,d),i=l.a.parse(a,{delimiter:u});this.page=i.currentPage?1*i.currentPage:this.page,this.size=i.pageSize?1*i.pageSize:this.size,this.phSort.prop=i.sort?i.sort:this.phSort.prop,this.phSort.order=i.dir?i.dir:this.phSort.order,i.name&&(this.searchParam.name.value=i.name),null!==i.status&&(this.searchParam.status.value=i.status)}this.$nextTick(function(){t.getTableHeight(),t.getList()})},methods:{getTableHeight:function(){if("mobile"!==this.device){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=t;e-=84,e-=82,e-=this.$refs.searchForm?this.$refs.searchForm.$el.offsetHeight:0,e-=this.$refs.operationForm?this.$refs.operationForm.$el.offsetHeight:0,e-=this.$refs.pageForm?this.$refs.pageForm.$el.offsetHeight:0,e-=42,this.tableMaxHeight=e}else this.tableMaxHeight=400},getList:function(t){var e=this,a=this.url,i=this.countUrl,n="",r="",s=this.size,o=this.page;if(a){a.indexOf("?")>-1?a+="&":a+="?",i.indexOf("?")>-1?i+="&":i+="?",n+="pageSize=".concat(s,"&currentPage=").concat(o),r+="pageSize=".concat(s,"&currentPage=").concat(o),this.phSort&&(n+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order),r+="&sort=".concat(this.phSort.prop,"&dir=").concat(this.phSort.order));var l=[];if(Object.keys(this.searchParam).filter(function(t){return e.searchParam[t]&&""!==e.searchParam[t].value&&null!==e.searchParam[t].value&&void 0!==e.searchParam[t].value}).forEach(function(t){l.push({field:t,op:e.searchParam[t].op?e.searchParam[t].op:"eq",data:e.searchParam[t].value?encodeURIComponent(e.searchParam[t].value.toString().trim()):""})}),l.forEach(function(t,e){r+="&"+t.field+"="+encodeURIComponent(t.data?t.data.toString().trim():"")}),l&&l.length>0&&(n+="&filters="+JSON.stringify({groupOp:"AND",rules:l})),this.relations&&this.relations.length>0&&(n+="&relations="+JSON.stringify(this.relations)),this.loading=!0,this.global.axios.get(i+n).then(function(t){var a=t.data;e.total=a||0}).catch(function(t){}),this.global.axios.get(a+n).then(function(t){var a=t.data,i=a||[];e.data=i,e.loading=!1,e.$emit("update",i,a)}).catch(function(t){e.$emit("error",t),e.loading=!1}),t>0){var h="",d=f+r.replace(/&/g,u).replace(p,c)+u;if(location.href.indexOf(f)>-1)h=location.href.replace(g,d);else{var m=location.hash.indexOf("?")>-1?"&".concat(d):"?".concat(d);h=location.origin+location.pathname+location.search+location.hash+m}history.pushState(history.state,"ph-table search",h)}}else console.warn("url 为空, 不发送请求")},search:function(){var t=this;this.$refs.searchForm.validate(function(e){e&&(t.page=1,t.getList(!0))})},resetSearch:function(){var t=this;this.$refs.searchForm.resetFields(),this.searchParam.name.value=null,this.searchParam.status.value=null,this.page=1,history.replaceState(history.state,"",location.href.replace(g,"")),this.$nextTick(function(){t.getList()}),this.$emit("reset"),this.$emit("update:customQuery",Object.assign(this.customQuery,JSON.parse(this.initCustomQuery)))},dangerClassName:function(t){t.row;return""},handleSizeChange:function(t){this.size!==t&&(this.page=1,this.size=t,this.getList(!0))},handleCurrentChange:function(t){this.page!==t&&(this.page=t,this.getList(!0))},handleSelectionChange:function(t){this.selected=t,this.$emit("selection-change",t)},handleSortChange:function(t){t.prop&&(this.phSort.prop=t.prop,this.phSort.order="ascending"===t.order?"asc":"desc"),this.page=1,this.getList(!0)},handleFilterChange:function(t){for(var e in t)e,t[e]},onDefaultEdit:function(t){var e=this;this.$message.info(t.id);var a="/products/"+t.id;this.relations&&this.relations.length>0&&(a+="?relations="+JSON.stringify(this.relations)),this.global.axios.get(a).then(function(t){var a={title:"编辑产品",component:createFrom,_top_:"3vh",_width_:"90%",data:t.data,callback:function(t){t&&e.getList()}};common.dialog(a)}).catch(function(t){})},onDefaultSetting:function(t){this.$emit("openRoleList",t.id,t.name),this.$message.info(t.id+"")},cancel:function(){},confirm:function(){},onRefreshTable:function(){this.getList()}}},b=m,v=(a("7287"),a("2877")),S=Object(v["a"])(b,i,n,!1,null,"5dc79938",null);e["default"]=S.exports}}]);