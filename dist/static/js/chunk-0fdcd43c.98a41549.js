(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fdcd43c","chunk-197fcb99","chunk-71570c36","chunk-428c57c7"],{"2a9c":function(t,e,i){},4084:function(t,e,i){"use strict";var a=i("7fea"),n=i.n(a);n.a},"54ae":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-upload",{staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-preview":t.handlePreview,"on-success":t.handleSuccess,multiple:"","file-list":t.attachments}})],1)},n=[],l=(i("7f7f"),i("ac6a"),i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{uploadUrl:function(){return"".concat(this.global.generateUrl(this.url),"/uploadFiles/").concat(this.primary.id,"?accessToken=").concat(this.$store.state.user.token)}},data:function(){return{url:"/attachments/procurementShippedOrder",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){var t=this;if(this.primary){var e=this.url;this.filters&&this.filters.length>0&&(e+="?filters="+JSON.stringify({groupOp:"AND",rules:this.filters})),this.relations&&this.relations.length>0&&(e+="&relations="+JSON.stringify(this.relations)),this.global.axios.get(e).then(function(e){var i=e.data,a=i||[];t.attachments=[],a.forEach(function(e){t.attachments.push({id:e.id,name:e.fileName,url:"".concat(t.global.generateUrl(t.url),"/view/").concat(e.id,"?accessToken=").concat(t.$store.state.user.token)})})}).catch(function(t){})}},remove:function(t){var e=this;if(this.primary){var i="".concat(this.global.generateUrl(this.url),"/").concat(t.id,"?accessToken=").concat(this.$store.state.user.token);this.global.axios.delete(i).then(function(t){e.$message.info("附件删除成功!")}).catch(function(t){})}},handleSuccess:function(){this.initData()},handlePreview:function(t){window.open(t.url,"_blank")},beforeRemove:function(t,e){var i=this;return this.$confirm("确定移除 ".concat(t.name,"？"),"提示",{beforeClose:function(e,a,n){"confirm"==e?(i.remove(t),n(!0)):n(!1)}})}}}),r=l,o=(i("4084"),i("2877")),s=Object(o["a"])(r,a,n,!1,null,"55e8d274",null);e["default"]=s.exports},5596:function(t,e,i){},"5c75":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogVisible?i("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,fullscreen:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-row",{staticStyle:{"margin-bottom":"20px"}},[4===t.primary.status?i("el-button",{attrs:{type:"success",icon:"el-icon-s-flag"},on:{click:t.onConfirm}},[t._v("一键确认")]):t._e(),t._v(" "),4===t.primary.status?i("el-button",{attrs:{type:"success",icon:"el-icon-s-claim"},on:{click:t.onComplete}},[t._v("收货完成")]):t._e(),t._v(" "),4===t.primary.status?i("el-button",{attrs:{type:"success",icon:"el-icon-printer",disabled:!0},on:{click:t.onPrint}},[t._v("打印收货单")]):t._e()],1),t._v(" "),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"infoFrom"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("1. 基本信息")]),t._v(" "),i("infoFrom",{ref:"infoFrom",attrs:{primary:t.primary},on:{modifyCBEvent:t.modifyCBEvent}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"itemTable"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("2. 确认收货")]),t._v(" "),i("itemTable",{ref:"itemTable",attrs:{primary:t.primary}})],1),t._v(" "),i("el-collapse-item",{staticStyle:{"margin-top":"10px"},attrs:{name:"attachment"}},[i("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("3. 附件")]),t._v(" "),i("attachment",{ref:"attachment",attrs:{primary:t.primary}})],1)],1)],1):t._e()},n=[],l=i("7819"),r=i("b76e"),o=i("54ae"),s=i("7556"),c={components:{infoFrom:l["default"],itemTable:r["default"],attachment:o["default"],person:s["default"]},props:{},computed:{title:function(){return"采购入库  ---  ["+this.primary.code+"] --- ("+this.primary.statusName+"状态)"}},data:function(){return{primaryId:null,primary:{},dialogVisible:!1,activeNames:[]}},created:function(){},mounted:function(){this.$nextTick(function(){})},methods:{initData:function(){var t=this;this.primaryId&&this.global.axios.get("/procurementReceivedOrders/".concat(this.primaryId)).then(function(e){var i=e.data;t.primary=i||{},t.dialogVisible=!0}).catch(function(t){})},openDialog:function(t){this.primaryId=t,this.initData(),this.activeNames=["infoFrom","itemTable"]},modifyCBEvent:function(t){this.$emit("modifyCBEvent",t)},onConfirm:function(){var t=this;this.global.axios.put("/procurementReceivedOrders/confirmTask/".concat(this.primaryId)).then(function(e){t.$message.info("确认收货成功,请"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!0,t.formVisible=!1,t.$refs.itemTable.getList(),t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})},onComplete:function(){var t=this;this.global.axios.put("/procurementReceivedOrders/receivedTask/".concat(this.primaryId)).then(function(e){t.$message.info("收货完成"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})},onPrint:function(){var t=this;this.global.axios.get("/attachments/procurementShippedOrders/".concat(this.primaryId)).then(function(e){t.$message.info("打印收货单"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})}}},d=c,u=(i("a08c"),i("2877")),m=Object(u["a"])(d,a,n,!1,null,"27f43f0e",null);e["default"]=m.exports},7556:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"tag-group"},[t._l(t.primary.dataAuthories,function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleRemove(e)}}},[t._v("\n      "+t._s(e.user.name)+"\n    ")])}),t._v(" "),i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.openPersonDialog}},[t._v("+ 添加负责人")])],2)])},n=[],l=(i("ed08"),{components:{},props:{primary:{type:[Object],default:{}}},computed:{},data:function(){return{url:"/attachments/procurementPlan",relations:["creator"],filters:[{field:"relevanceId",op:"eq",data:this.primary.id}],attachments:[]}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){},openPersonDialog:function(){},handleRemove:function(){this.initData()}}}),r=l,o=(i("d45e"),i("2877")),s=Object(o["a"])(r,a,n,!1,null,"008c78ee",null);e["default"]=s.exports},7819:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"editObject",attrs:{rules:t.rules,model:t.editObject,"status-icon":"",inline:"","label-position":"right","label-width":"120px"}},[i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"编码",prop:"code"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.editObject.code,callback:function(e){t.$set(t.editObject,"code",e)},expression:"editObject.code"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"预计到货时间",prop:"expectTime"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",disabled:!0,placeholder:"预计到货时间"},model:{value:t.editObject.expectTime,callback:function(e){t.$set(t.editObject,"expectTime",e)},expression:"editObject.expectTime"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"收货日期",prop:"receivedTime"}},[i("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"请选择收货日期！！！！",disabled:t.disable},model:{value:t.editObject.receivedTime,callback:function(e){t.$set(t.editObject,"receivedTime",e)},expression:"editObject.receivedTime"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"供货商",prop:"supplierId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.editObject.supplierId,callback:function(e){t.$set(t.editObject,"supplierId",e)},expression:"editObject.supplierId"}},t._l(t.supplierSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"收货仓库",prop:"warehouseId"}},[i("el-select",{staticStyle:{width:"220px"},attrs:{disabled:!0},model:{value:t.editObject.warehouseId,callback:function(e){t.$set(t.editObject,"warehouseId",e)},expression:"editObject.warehouseId"}},t._l(t.warehouseSelectOptions,function(t,e){return i("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"物流单号",prop:"trackNumber"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",placeholder:"请填写单号",disabled:!0},model:{value:t.editObject.trackNumber,callback:function(e){t.$set(t.editObject,"trackNumber",e)},expression:"editObject.trackNumber"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:14}},[i("el-form-item",{attrs:{label:"物流公司",prop:"channel"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",disabled:!0},model:{value:t.editObject.channel,callback:function(e){t.$set(t.editObject,"channel",e)},expression:"editObject.channel"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:10}},[i("el-form-item",{attrs:{label:"车牌",prop:"plateNumber"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",disabled:!0},model:{value:t.editObject.plateNumber,callback:function(e){t.$set(t.editObject,"plateNumber",e)},expression:"editObject.plateNumber"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:8}},[i("el-form-item",{attrs:{label:"联系人",prop:"linkman"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",disabled:!0},model:{value:t.editObject.linkman,callback:function(e){t.$set(t.editObject,"linkman",e)},expression:"editObject.linkman"}})],1)],1),t._v(" "),i("el-col",{attrs:{md:8}},[i("el-form-item",{attrs:{label:"电话",prop:"tel"}},[i("el-input",{staticStyle:{width:"220px"},attrs:{"show-word-limit":"",disabled:!0},model:{value:t.editObject.tel,callback:function(e){t.$set(t.editObject,"tel",e)},expression:"editObject.tel"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-form-item",{attrs:{label:"备注",prop:"remark"}},[i("el-col",{attrs:{span:22}},[i("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:"3",cols:"80",disabled:!0,"show-word-limit":""},model:{value:t.editObject.remark,callback:function(e){t.$set(t.editObject,"remark",e)},expression:"editObject.remark"}})],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{md:24}},[i("el-row",{attrs:{type:"flex",justify:"center"}},[t.hasEdit?i("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",loading:t.confirmLoading},on:{click:t.onSave}},[t._v("\n          保存基本信息\n        ")]):t._e()],1)],1)],1)],1)},n=[],l=(i("ac6a"),i("64dc")),r=(i("ed08"),i("a6b9")),o={components:{},props:{primary:{type:[Object],default:{}}},computed:{hasEdit:function(){return!([6].indexOf(this.primary.status)>-1)}},data:function(){return{disable:!1,loading:!1,confirmLoading:!1,warehouseSelectOptions:[],supplierSelectOptions:[],editObject:{id:null,code:null,warehouseId:null,supplierId:null,remark:null,trackNumber:null,expectTime:null,linkman:null,receivedTime:null},rules:{}}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){t.initData()})},methods:{initData:function(){if(this.loading=!0,this.primary){this.editObject=this.primary,this.editObject.expectTime=this.primary.formatExpectTime,this.editObject.receivedTime=this.primary.formatReceivedTime,this.editObject.warehouseId=this.editObject.warehouseId+"",this.editObject.supplierId=this.editObject.supplierId+"",this.warehouseSelectOptions=l["a"].getSelectDomesticOptions(),this.supplierSelectOptions=r["a"].getSelectOptions();var t=!0;this.warehouseSelectOptions.forEach(function(e){"-99"==e.value&&(t=!1)}),t&&this.warehouseSelectOptions.unshift({label:"供货商库存",value:"-99"}),this.loading=!1}else this.$message.error("无效!"),this.loading=!1;6===this.primary.status&&(this.disable=!0,this.loading=!1)},onSave:function(){var t=this;this.global.axios.put("/procurementReceivedOrders/receivedTime/".concat(this.primary.id),this.primary).then(function(e){t.$message.info("保存成功"),t.loading=!1,t.confirmLoading=!1,t.dialogVisible=!1,t.$emit("modifyCBEvent",e.data)}).catch(function(e){t.loading=!1,t.confirmLoading=!1})}}},s=o,c=(i("7f46"),i("2877")),d=Object(c["a"])(s,a,n,!1,null,"59a7774e",null);e["default"]=d.exports},"7f46":function(t,e,i){"use strict";var a=i("e7bf"),n=i.n(a);n.a},"7fea":function(t,e,i){},a08c:function(t,e,i){"use strict";var a=i("2a9c"),n=i.n(a);n.a},d45e:function(t,e,i){"use strict";var a=i("5596"),n=i.n(a);n.a},e7bf:function(t,e,i){}}]);